# CONSTRUINDO A BASE DE DADOS -----

# instalar e rodar pacote
install.packages("tidyr")
install.packages("stringr")
library(stringr)
library(tidyr)
library(dplyr)
library(readxl)
library(stringr)
library(tidyverse)

# Lista dos códigos das unidades federativas do Brasil
ufs <- c("RO", "AC", "AM", "RR", "PA", "AP", "TO", "MA", "PI", "CE", "RN", "PB",
         "PE", "AL", "SE", "BA", "MG", "ES", "RJ", "SP", "PR", "SC", "RS", "MS",
         "MT", "GO", "DF")

# Data frame vazio para armazenar os dados combinados
dados_gerais <- data.frame()

# Loop para baixar e combinar os dados de cada UF
for (uf in ufs) {
  # Baixa os dados do SIM para cada UF de 2017 a 2022
  dados_uf <- fetch_datasus(year_start = 2017, year_end = 2022,
                            uf = uf,
                            information_system = "SIM-DO")
  
  # Adiciona os dados da UF atual ao data frame geral
  dados_gerais <- bind_rows(dados_gerais, dados_uf)
}

# Visualize as primeiras linhas dos dados gerais
head(dados_gerais)
dim(dados_gerais)

# salvar a base em csv
write.csv(dados_gerais, file = "dados_gerais_br.csv")
base_1 <- read.csv("dados_gerais_br.csv", header = T)
View(base_1)
str(base_1)

# Selecionar apenas as variáveis desejadas
base_2 <- base_1[, c("SEXO", "RACACOR", "IDADE", "ESC", "ESTCIVIL", "CODMUNRES", "CAUSABAS", "ASSISTMED", "OCUP", "EXAME")]

# Salvar a nova base em um arquivo CSV
write.csv(base_2, file = "base_2.csv", row.names = FALSE)
base_2 <- read.csv("base_2.csv", header = T)

# revendo a base
base_2 %>% colnames()

# revendo as categorias em cada variavel
base_2$SEXO  %>% unique %>% sort
base_2$RACACOR %>% unique %>% sort
base_2$IDADE %>% unique %>% sort
base_2$ESTCIV %>% unique %>% sort
base_2$ESC %>% unique %>% sort
base_2$OCUP %>% unique %>% sort
base_2$CODMUNRES %>% unique %>% sort
base_2$ASSISTMED %>% unique %>% sort
base_2$EXAME %>% unique %>% sort
base_2$CAUSABAS %>% unique %>% sort

# TRABALHANDO COM CADA VARIAVEL SEPARADAMENTE-----

## Sexo -----

base_2$SEXO %>% glimpse
base_2$SEXO %>% table (useNA = "always")# 1 masculino, 2 feminino 0, 9 e NA transforma em 999 ignorado
base_2$SEXO_NOVO <- ifelse(base_2$SEXO == 1,1,
                               ifelse(base_2$SEXO == 2,2, 999)) #recategorizei
base_2 %>% mutate_at(vars("SEXO_NOVO"), ~replace_na(. , 999))#tranformei os NA em 999
base_2<- base_2 %>% mutate_at(vars("SEXO_NOVO"), ~replace_na(.,999))#tranformei os NA em 999
base_2 %>% colnames # verificando as variaveis   
base_2$SEXO_NOVO %>% table() # 1 masculino 2 feminino 999 ignorados ou vazios
base_2$SEXO %>% table()
base_2 %>% relocate(SEXO_NOVO, .after = "SEXO") #realocando a nova variavel ao lado da antiga
base_2 <- base_2 %>% relocate(SEXO_NOVO, .after = "SEXO") #atribui um objeto a mudança

#dando nome 
base_2 <- base_2 %>% mutate(SEXO_NOVO = case_when(
  SEXO == 1 ~ "Masculino",
  SEXO == 2 ~ "Feminino",
  TRUE ~ "999"))
base_2$SEXO_NOVO <- as.factor(base_2$SEXO_NOVO)

## Racacor -----
base_2$RACACOR %>% glimpse
base_2$RACACOR %>% table (useNA = "always")# 1 branca 2 preta 3 amarela 4 parda 5 indigena
base_2$RACACOR_NOVO <- ifelse(base_2$RACACOR == 1,1,
                              ifelse (base_2$RACACOR == 2,2,
                                           ifelse (base_2$RACACOR == 3,3,
                                                   ifelse (base_2$RACACOR == 4,4,
                                                          ifelse (base_2$RACACOR == 5,5,999)))))
base_2 %>% mutate_at(vars("RACACOR_NOVO"), ~replace_na(.,999))#tranformei os NA em 999
base_2 <- base_2 %>% mutate_at(vars("RACACOR_NOVO"), ~replace_na(.,999)) #criei um df
base_2 %>% colnames # verificando as variaveis
base_2$RACACOR_NOVO %>% table (useNA = "always") # verificando NA
base_2$RACACOR %>% table(useNA = "always")
base_2 %>% relocate(RACACOR_NOVO, .after = "RACACOR") #realocando a nova variavel ao lado da antiga
base_2 <- base_2 %>% relocate(RACACOR_NOVO, .after = "RACACOR") #atribui um objeto a mudan?a
#dando nome
base_2 <- base_2 %>% mutate(RACACOR_NOVO = case_when(
  RACACOR == 1 ~ "Branca",
  RACACOR == 2 ~ "Preta",
  RACACOR == 3 ~ "Amarela",
  RACACOR == 4 ~ "Parda",
  RACACOR == 5 ~ "Indígena",
  TRUE ~ "999"))
base_2$RACACOR_NOVO <- as.factor(base_2$RACACOR_NOVO)
table(base_2$RACACOR_NOVO)

##Idade -----

# Remover espaços em branco e outros caracteres não numéricos da variável IDADE
base_2$IDADE_NOVO_NUM <- as.numeric(gsub("[^0-9]", "", base_2$IDADE))

# Exibir a coluna de idades limpas
base_2$IDADE_NOVO_NUM

# Função para converter os valores da coluna "IDADE_NOVO" em idades reais de dois dígitos
converte_idade <- function(x) {
 if (is.na(x)) {
     idade <- NA
     } else {
     unidade <- substr(x, 1, 1)
     quantidade <- as.numeric(substr(x, 2, 3))
     if (unidade == "0") {
       idade <- NA
     } else if (unidade == "1") {
      idade <- quantidade
     } else if (unidade == "2") {
       idade <- quantidade
     } else if (unidade == "3") {
       idade <- quantidade
     } else if (unidade == "4") {
       idade <- quantidade
     } else if (unidade == "5") {
       idade <- quantidade + 100
        } else {
         idade <- NA}}
  return(idade)}

# Aplicar a função à coluna "IDADE_NOVO" para obter as idades reais de dois dígitos

base_2$IDADE_REAL <- sapply(base_2$IDADE_NOVO_NUM, converte_idade)

# Exibir a coluna de idades reais

base_2$IDADE_REAL

## categorizando conforme dicionario

base_2$IDADE %>% glimpse
base_2$IDADE %>% table (useNA = "always")
base_2$IDADE_NOVO <- ifelse(base_2$IDADE < 418,0,
                                 ifelse ((base_2$IDADE >= 418) & (base_2$IDADE <= 429),1,
                                         ifelse ((base_2$IDADE >= 430) & (base_2$IDADE <= 439),2,
                                                 ifelse ((base_2$IDADE >= 440) & (base_2$IDADE <= 449),3,
                                                         ifelse ((base_2$IDADE >= 450) & (base_2$IDADE <= 459),4,
                                                                 ifelse ((base_2$IDADE >= 460) & (base_2$IDADE <= 469),5,
                                                                        ifelse ((base_2$IDADE >= 470) & (base_2$IDADE <= 529),6,999)))))))
base_2%>% mutate_at(vars("IDADE_NOVO"), ~replace_na(.,999))#tranformei os NA em 999
base_2 <- base_2%>% mutate_at(vars("IDADE_NOVO"), ~replace_na(.,999)) #criei um df-
base_2%>% mutate_at(vars("IDADE_REAL"), ~replace_na(.,999))#tranformei os NA em 999
base_2 <- base_2%>% mutate_at(vars("IDADE_REAL"), ~replace_na(.,999)) #criei um df
base_2 %>% mutate_at(vars("IDADE_NOVO_NUM"), ~replace_na(.,999))#tranformei os NA em 999
base_2 <- base_2%>% mutate_at(vars("IDADE_NOVO_NUM"), ~replace_na(.,999)) #criei um df
base_2 %>% colnames # verificando as variaveis 
base_2$IDADE_REAL %>% table (useNA = "always") # verificando NA
base_2 %>% relocate(IDADE_NOVO, .after = "IDADE") #realocando a nova variavel ao lado da antiga
base_2 <- base_2 %>% relocate(IDADE_NOVO, .after = "IDADE") #atribui um objeto a mudan?a
base_2 %>% relocate(IDADE_REAL, .after = "IDADE_NOVO") #realocando a nova variavel ao lado da antiga
base_2 <- base_2 %>% relocate(IDADE_REAL, .after = "IDADE_NOVO") #atribui um objeto a mudan?a
base_2 %>% relocate(IDADE_NOVO_NUM, .after = "IDADE_REAL") #realocando a nova variavel ao lado da antiga
base_2 <- base_2 %>% relocate(IDADE_NOVO_NUM, .after = "IDADE_REAL") #atribui um objeto a mudan?a
base_2%>% colnames
#dando nome
base_2$IDADE_NOVO <- factor(base_2$IDADE_NOVO, #objeto
                                levels = c("0","1","2","3","4","5","6"), # niveis do objeto
                                labels = c("<18","18-29","30-39","40-49","50-59","60-69",">70")) #renomeando niveis
base_2$IDADE_NOVO <- as.factor(base_2$IDADE_NOVO)

## Estcivil -----

base_2$ESTCIV %>% glimpse
base_2$ESTCIV %>% table (useNA = "always")# 1 solteiro 2 casado 3 viuvo 4 separado judicialmente 9 e NA transformado em ignorado
base_2$ESTCIV_NOVO <- ifelse(base_2$ESTCIV == 1,1,
                               ifelse (base_2$ESTCIV == 2,2,
                                        ifelse (base_2$ESTCIV == 3,3,
                                               ifelse (base_2$ESTCIV == 4,4, 999))))
base_2 %>% mutate_at(vars("ESTCIV_NOVO"), ~replace_na(.,999))#tranformei os NA em 999
base_2 <- base_2%>% mutate_at(vars("ESTCIV_NOVO"), ~replace_na(.,999)) #criei um df
base_2 %>% colnames # verificando as variaveis
base_2$ESTCIV_NOVO %>% table (useNA = "always") # verificando NA
base_2$ESTCIV %>% table(useNA = "always")
base_2 %>% relocate(ESTCIV_NOVO, .after = "ESTCIV") #realocando a nova variavel ao lado da antiga
base_2 <- base_2 %>% relocate(ESTCIV_NOVO, .after = "ESTCIV") #atribui um objeto a mudan?a
base_2 %>% colnames
#dando nome
base_2 <- base_2 %>% mutate(ESTCIV_NOVO = case_when(
  ESTCIV == 1 ~ "Solteiro",
  ESTCIV == 2 ~ "Casado",
  ESTCIV == 3 ~ "Viuvo",
  ESTCIV == 4 ~ "Separado judicialmente",
  TRUE ~ "999"))
base_2$ESTCIV_NOVO <- as.factor(base_2$ESTCIV_NOVO)

## Escolaridade -----

base_2$ESC %>% glimpse
base_2$ESC %>% table (useNA = "always")# 1 nenhuma 2 (1 a 3 anos) 3 (4 a7 anos) 4 (8 a 11) 5(12 e mais)
base_2$ESC_NOVO <- ifelse(base_2$ESC == 1,1,
                               ifelse (base_2$ESC == 2,1,
                                       ifelse (base_2$ESC == 3,2,
                                               ifelse (base_2$ESC == 4,3,
                                                      ifelse(base_2$ESC == 5,4,999)))))
base_2 %>% mutate_at(vars("ESC_NOVO"), ~replace_na(.,999))#tranformei os NA em 999
base_2 <- base_2 %>% mutate_at(vars("ESC_NOVO"), ~replace_na(.,999)) #criei um df
base_2 %>% colnames # verificando as variaveis
base_2$ESC_NOVO %>% table (useNA = "always") # verificando NA
base_2$ESC %>% table(useNA = "always")
base_2 %>% relocate(ESC_NOVO, .after = "ESC") #realocando a nova variavel ao lado da antiga
base_2 <- base_2 %>% relocate(ESC_NOVO, .after = "ESC") #atribui um objeto a mudan?a
base_2%>% colnames # verificando as variaveis 
#dando nome
base_2 <- base_2 %>% mutate(ESC_NOVO = case_when(
  ESC == 1 ~ " <= 3 anos",
  ESC == 2 ~ "4 a 7 anos",
  ESC == 3 ~ "8 a 11 anos",
  ESC == 4 ~ ">= 12 anos",
  TRUE ~ "999"))
base_2$ESC_NOVO <- as.factor(base_2$ESC_NOVO)

##Ocup-----

# originalmente estava como int mas vou transformar em chr
class(base_2$OCUP) = "chr" #mudando para tipo caracter
base_2 %>% glimpse
#colocar o valor zero na frente das CBOs com apenas cinco digitos
base_2$OCUP_NOVO <- ifelse(str_length(base_2$OCUP)== 5, str_c("0", base_2$OCUP),
                               base_2$OCUP) 
base_2$OCUP_NOVO %>% unique %>% head(1000) %>%  sort

#transformando NA em 999
base_2 <- base_2 %>% mutate_at(vars("OCUP_NOVO"), ~replace_na(.,"999"))#tranformei os NA em 999
base_2 <- base_2%>% relocate(OCUP_NOVO, .after = "OCUP") #realocando a nova variavel ao lado da antiga
base_2 %>% colnames
base_2$OCUP %>% sort %>% table(useNA = "always") %>%  head(10) 
base_2$OCUP_NOVO %>%  sort %>% table(useNA = "always") %>%  head(10)
base_2$OCUP  %>% table(useNA = "always") %>%  tail(10) 
base_2$OCUP_NOVO  %>% table(useNA = "always") %>%  tail(10)

#verificando os NA
base_2 %>%  filter(OCUP_NOVO=="999") %>% dim #dim para mostrar o tamanho

## criando a variavel ocup_novo_cat1D (1 digito) que ter? s? o primeiro digito
base_2$OCUP_NOVO_CAT1D <- ifelse (base_2$OCUP_NOVO != "999",
                                      substr(base_2$OCUP_NOVO, 1,1),
                                      "999")
base_2 %>% colnames
base_2$OCUP_NOVO_CAT1D %>% table %>% head (10)

## criando a variavel ocup_novo_cat2D (2 digito) que ter dois digitos
base_2$OCUP_NOVO_CAT2D <- ifelse (base_2$OCUP_NOVO != "999",
                                      substr(base_2$OCUP_NOVO, 1,2),
                                      "999")
base_2 %>% colnames
base_2$OCUP_NOVO_CAT2D %>% table %>% head (10)
base_2$OCUP_NOVO_CAT2D %>% table %>% tail (10)
base_2 <- base_2 %>% relocate(OCUP_NOVO_CAT1D, .after = "OCUP_NOVO") #realocando a nova variavel ao lado da antiga
base_2 %>% relocate(OCUP_NOVO_CAT2D, .after = "OCUP_NOVO_CAT1D") 
base_2%>% glimpse
base_2 <- base_2 %>% relocate(OCUP_NOVO_CAT2D, .after = "OCUP_NOVO_CAT1D") #atribui um objeto a mudança
base_2 %>% colnames

#dando nome
# OCUP_NOVO_CAT2D

base_2 <- base_2 %>% 
  mutate(OCUP_NOVO_CAT2D = case_when(
    OCUP_NOVO_CAT2D %in% c(61, 62, 64) ~ "1",
    OCUP_NOVO_CAT2D == "999" ~ "999",
    TRUE ~ "2"))
base_2$OCUP_NOVO_CAT2D <- as.factor(base_2$OCUP_NOVO_CAT2D)

##Codmunres-----

base_2$MACRORREGIAO <- substr(base_2$CODMUNRES, 1,1)
base_2$MACRORREGIAO [base_2$MACRORREGIAO == 1] <- "NORTE"
base_2$MACRORREGIAO [base_2$MACRORREGIAO == 2] <- "NORDESTE"
base_2$MACRORREGIAO [base_2$MACRORREGIAO == 3] <- "SUDESTE"
base_2$MACRORREGIAO [base_2$MACRORREGIAO == 4] <- "SUL"
base_2$MACRORREGIAO [base_2$MACRORREGIAO == 5] <- "CENTRO-OESTE"

base_2 %>% mutate_at(vars("MACRORREGIAO"), ~replace_na(.,999))#tranformei os NA em 999
base_2 <- base_2 %>% mutate_at(vars("MACRORREGIAO"), ~replace_na(.,999)) #criei um df
base_2 %>% colnames # verificando as variaveis
base_2 %>% relocate(MACRORREGIAO, .after = "CODMUNRES") #realocando a nova variavel ao lado da antiga
base_2 <- base_2 %>% relocate(MACRORREGIAO, .after = "CODMUNRES") #atribui um objeto a mudan?a
base_2 %>% colnames

##Tipologia IBGE----

table(base_2$CODMUNRES)

base_2 <- base_2 %>%
  mutate(TIPOLOGIA = ifelse(CODMUNRES %in% c("110007", "110008", "110013", "110032", "110033", "110092", "110146", "110149", "110150", "110175", 
                                             "120005", "120032", "120034", "120035", "120039", "120043", "130002", "130006", "130008", "130010", 
                                             "130020", "130030", "130050", "130063", "130068", "130080", "130083", "130090", "130180", "130195", 
                                             "130210", "130220", "130270", "130280", "130290", "130300", "130310", "130350", "130360", "130390", 
                                             "130395", "130423", "130426", "130430", "130440", "140023", "140045", "140047", "140050", "140060", 
                                             "140070", "150030", "150034", "150070", "150085", "150100", "150110", "150200", "150250", "150280", 
                                             "150285", "150300", "150310", "150375", "150450", "150490", "150548", "150565", "150590", "150600", 
                                             "150619", "150630", "150658", "150770", "150775", "150780", "150805", "160005", "160015", "160020", 
                                             "160055", "160070", "160080", "170190", "170200", "170270", "170384", "170389", "170390", "170410", 
                                             "170510", "170560", "170600", "170710", "170720", "170830", "171050", "171150", "171180", "171190", 
                                             "171215", "171240", "171270", "171420", "171515", "171525", "171575", "171620", "171665", "171670", 
                                             "171700", "171780", "171800", "171850", "171865", "171884", "171888", "172015", "172025", "172090", 
                                             "172093", "210050", "210083", "210095", "210130", "210170", "210407", "210408", "210409", "210500", 
                                             "210535", "210547", "210596", "210610", "210670", "210730", "210805", "210940", "210970", "211027", 
                                             "211065", "211080", "211102", "211157", "211178", "211190", "211200", "220045", "220080", "220110", 
                                             "220115", "220117", "220130", "220155", "220170", "220211", "220225", "220245", "220275", "220300", 
                                             "220310", "220320", "220323", "220360", "220380", "220400", "220440", "220455", "220545", "220552", 
                                             "220560", "220585", "220590", "220660", "220665", "220667", "220730", "220735", "220740", "220760", 
                                             "220785", "220793", "220810", "220855", "220870", "220885", "220887", "220890", "220900", "220920", 
                                             "220930", "220965", "220975", "221010", "221039", "221062", "221063", "221090", "260545", "290010", 
                                             "290020", "290270", "290400", "290410", "290450", "290475", "290755", "290770", "290810", "290910", 
                                             "291077", "291250", "291300", "291410", "291980", "291990", "292045", "292160", "292303", "292320", 
                                             "292430", "292440", "292690", "310650", "310825", "311455", "311700", "311783", "311950", "312650", 
                                             "312733", "313065", "313652", "313657", "313695", "313862", "314225", "314270", "314537", "314675", 
                                             "315510", "315560", "315650", "315660", "316245", "317065", "317160", "430865", "431171", "500025", 
                                             "500215", "500280", "500390", "500430", "500440", "500635", "500640", "500690", "500770", "500795", 
                                             "510035", "510050", "510080", "510120", "510185", "510190", "510260", "510268", "510269", "510279", 
                                             "510285", "510325", "510336", "510337", "510380", "510385", "510450", "510452", "510454", "510460", 
                                             "510500", "510517", "510530", "510550", "510558", "510560", "510615", "510617", "510618", "510619", 
                                             "510620", "510621", "510624", "510626", "510627", "510628", "510629", "510631", "510645", "510670", 
                                             "510677", "510680", "510706", "510715", "510718", "510726", "510735", "510774", "510776", "510777", 
                                             "510779", "510785", "510788", "510794", "510800", "510805", "510810", "510830", "510835", "510880", 
                                             "510885", "510890", "510895"), 1,
                            ifelse(CODMUNRES %in% c("110014", "110026", "110029", "110034", "110037", "110040", "110050", "110060", "110070", "110090", 
                                                    "110100", "110110", "110120", "110130", "110140", "110143", "110145", "110147", "110148", "110155", 
                                                    "110160", "110170", "110180", "120001", "120013", "120017", "120033", "120038", "120042", "120070", 
                                                    "120080", "130110", "130115", "130165", "130255", "130320", "130353", "130356", "130400", "140002", 
                                                    "140005", "140015", "140017", "140020", "140028", "140030", "140040", "150020", "150090", "150095", 
                                                    "150120", "150125", "150145", "150157", "150160", "150172", "150175", "150190", "150195", "150230", 
                                                    "150260", "150276", "150290", "150304", "150307", "150340", "150345", "150350", "150400", "150410", 
                                                    "150430", "150440", "150445", "150470", "150475", "150495", "150497", "150500", "150520", "150540", 
                                                    "150549", "150555", "150560", "150563", "150570", "150610", "150635", "150655", "150690", "150700", 
                                                    "150710", "150720", "150740", "150746", "150750", "150796", "150803", "150830", "150835", "160021", 
                                                    "160025", "160040", "170025", "170105", "170130", "170215", "170240", "170300", "170305", "170307", 
                                                    "170320", "170360", "170370", "170382", "170386", "170388", "170460", "170610", "170625", "170650", 
                                                    "170730", "170740", "170755", "170765", "170825", "170900", "170980", "171070", "171090", "171110", 
                                                    "171195", "171200", "171245", "171250", "171280", "171360", "171370", "171380", "171395", "171430", 
                                                    "171488", "171500", "171510", "171550", "171570", "171630", "171660", "171720", "171750", "171790", 
                                                    "171830", "171840", "171845", "171855", "171870", "171875", "171886", "171889", "171890", "171900", 
                                                    "172000", "172010", "172020", "172030", "172049", "172065", "172080", "172085", "172097", "172130", 
                                                    "172208", "210010", "210015", "210020", "210040", "210047", "210055", "210060", "210070", "210080", 
                                                    "210087", "210090", "210110", "210125", "210135", "210173", "210177", "210190", "210193", "210197", 
                                                    "210200", "210207", "210210", "210215", "210220", "210235", "210237", "210240", "210250", "210260", 
                                                    "210275", "210310", "210312", "210315", "210317", "210325", "210355", "210390", "210400", "210410", 
                                                    "210420", "210430", "210440", "210450", "210460", "210462", "210465", "210470", "210490", "210510", 
                                                    "210515", "210520", "210545", "210560", "210565", "210580", "210590", "210592", "210594", "210598", 
                                                    "210600", "210630", "210635", "210637", "210640", "210650", "210660", "210663", "210667", "210680", 
                                                    "210690", "210700", "210710", "210720", "210725", "210740", "210745", "210760", "210780", "210790", 
                                                    "210810", "210825", "210840", "210845", "210890", "210905", "210920", "210923", "210927", "210930", 
                                                    "210950", "210955", "210975", "211010", "211020", "211023", "211030", "211040", "211060", "211085", 
                                                    "211090", "211100", "211105", "211107", "211125", "211140", "211163", "211167", "211170", "211172", 
                                                    "211174", "211176", "211180", "211195", "211227", "211230", "211240", "211250", "211285", "211300", 
                                                    "220005", "220010", "220025", "220027", "220030", "220050", "220060", "220070", "220090", "220095", 
                                                    "220100", "220105", "220120", "220140", "220150", "220157", "220160", "220173", "220177", "220180", 
                                                    "220191", "220192", "220194", "220196", "220198", "220200", "220202", "220205", "220207", "220208", 
                                                    "220209", "220210", "220213", "220217", "220240", "220250", "220253", "220255", "220265", "220270", 
                                                    "220271", "220272", "220273", "220277", "220280", "220285", "220325", "220327", "220330", "220335", 
                                                    "220340", "220342", "220345", "220350", "220375", "220385", "220410", "220415", "220420", "220430", 
                                                    "220435", "220465", "220470", "220480", "220490", "220500", "220510", "220515", "220520", "220525", 
                                                    "220527", "220530", "220535", "220540", "220551", "220553", "220554", "220555", "220556", "220557", 
                                                    "220558", "220559", "220570", "220605", "220610", "220620", "220630", "220635", "220640", "220650", 
                                                    "220669", "220670", "220672", "220675", "220680", "220690", "220695", "220710", "220720", "220750", 
                                                    "220755", "220775", "220777", "220779", "220795", "220820", "220850", "220860", "220865", "220910", 
                                                    "220915", "220935", "220937", "220940", "220945", "220950", "220955", "220960", "220970", "220980", 
                                                    "220985", "220987", "220990", "220995", "220997", "221005", "221020", "221030", "221035", "221037", 
                                                    "221038", "221040", "221050", "221065", "221070", "221080", "221093", "221095", "221097", "221110", 
                                                    "221135", "221140", "221150", "221160", "221170", "230010", "230020", "230030", "230040", "230050", 
                                                    "230060", "230070", "230075", "230080", "230090", "230120", "230125", "230130", "230140", "230150", 
                                                    "230160", "230170", "230180", "230185", "230195", "230200", "230205", "230220", "230230", "230240", 
                                                    "230290", "230300", "230310", "230320", "230330", "230340", "230360", "230365", "230390", "230393", 
                                                    "230395", "230400", "230423", "230425", "230426", "230427", "230430", "230445", "230450", "230460", 
                                                    "230465", "230470", "230480", "230490", "230500", "230510", "230520", "230526", "230530", "230533", 
                                                    "230535", "230560", "230565", "230570", "230590", "230600", "230610", "230620", "230650", "230655", 
                                                    "230660", "230670", "230680", "230700", "230710", "230720", "230725", "230740", "230750", "230763", 
                                                    "230780", "230800", "230810", "230820", "230830", "230835", "230837", "230840", "230850", "230860", 
                                                    "230880", "230890", "230900", "230910", "230920", "230940", "230945", "230980", 
                                                    "230990", "231000", "231010", "231025", "231030", "231040", "231060", "231080", "231085", "231090", 
                                                    "231095", "231100", "231110", "231120", "231123", "231126", "231135", "231170", "231190", "231195", 
                                                    "231200", "231210", "231220", "231230", "231240", "231250", "231260", "231270", "231280", "231300", 
                                                    "231320", "231325", "231335", "231350", "231355", "231360", "231370", "231375", "231390", "231410", 
                                                    "240030", "240040", "240050", "240060", "240070", "240090", "240120", "240130", "240150", "240160", 
                                                    "240165", "240190", "240210", "240250", "240270", "240280", "240290", "240320", "240330", "240350", 
                                                    "240370", "240375", "240380", "240390", "240400", "240410", "240430", "240440", "240450", "240460", 
                                                    "240470", "240480", "240510", "240520", "240530", "240550", "240590", "240600", "240610", "240615", 
                                                    "240620", "240630", "240640", "240650", "240660", "240680", "240690", "240700", "240725", "240730", 
                                                    "240740", "240750", "240780", "240790", "240840", "240850", "240860", "240870", "240880", "240895", 
                                                    "240910", "240920", "240933", "240950", "240960", "240970", "240980", "240990", "241000", "241010", 
                                                    "241020", "241025", "241030", "241040", "241050", "241060", "241070", "241080", "241090", "241105", 
                                                    "241110", "241140", "241142", "241150", "241170", "241180", "241255", "241270", "241280", "241290", 
                                                    "241300", "241310", "241320", "241330", "241335", "241340", "241350", "241355", "241360", "241370", 
                                                    "241380", "241390", "241400", "241410", "241415", "241420", "241430", "241440", "241445", "241460", 
                                                    "241475", "241480", "241490", "241500", "250010", "250020", "250040", "250050", "250053", "250057", 
                                                    "250070", "250073", "250077", "250080", "250090", "250100", "250115", "250120", "250130", "250135", 
                                                    "250140", "250153", "250157", "250160", "250170", "250190", "250200", "250205", "250210", "250215", 
                                                    "250220", "250230", "250240", "250260", "250270", "250280", "250290", "250310", "250330", "250340", 
                                                    "250350", "250355", "250360", "250375", "250380", "250390", "250403", "250407", "250410", "250415", 
                                                    "250420", "250435", "250450", "250470", "250485", "250490", "250500", "250523", "250527", "250530", 
                                                    "250535", "250540", "250550", "250560", "250570", "250580", "250590", "250610", "250620", "250625", 
                                                    "250640", "250650", "250660", "250670", "250720", "250730", "250740", "250770", "250780", "250800", 
                                                    "250810", "250820", "250840", "250850", "250855", "250870", "250900", "250905", "250933", "250937", 
                                                    "250939", "250940", "250950", "250960", "250980", "250990", "251000", "251020", "251030", "251040", 
                                                    "251050", "251060", "251065", "251070", "251090", "251100", "251110", "251150", "251160", "251190", 
                                                    "251200", "251203", "251207", "251220", "251272", "251274", "251275", "251276", "251278", "251280", 
                                                    "251300", "251310", "251315", "251320", "251330", "251335", "251350", "251360", "251365", "251380", 
                                                    "251385", "251392", "251394", "251396", "251398", "251400", "251410", "251420", "251430", "251440", 
                                                    "251445", "251450", "251455", "251460", "251465", "251470", "251480", "251500", "251510", "251520", 
                                                    "251540", "251550", "251560", "251570", "251580", "251590", "251593", "251597", "251610", "251615", 
                                                    "251640", "251650", "251660", "251670", "251675", "251680", "251700", "251710", "251720", "251740", 
                                                    "260020", "260060", "260100", "260180", "260200", "260220", "260240", "260250", "260270", "260280", 
                                                    "260320", "260330", "260340", "260370", "260380", "260390", "260392", "260415", "260430", "260470", 
                                                    "260480", "260490", "260515", "260530", "260560", "260580", "260630", "260650", "260670", "260690", 
                                                    "260700", "260710", "260750", "260770", "260795", "260800", "260805", "260825", "260830", "260840", 
                                                    "260860", "260870", "260910", "260915", "260920", "260930", "260970", "260980", "261010", "261020", 
                                                    "261030", "261040", "261050", "261080", "261120", "261140", "261150", "261153", "261170", "261200", 
                                                    "261210", "261230", "261240", "261245", "261247", "261255", "261260", "261270", "261280", "261290", 
                                                    "261320", "261350", "261400", "261430", "261440", "261470", "261480", "261510", "261520", "261570", 
                                                    "261580", "261590", "261600", "261610", "261618", "261620", "261650", "270010", "270060", "270080", 
                                                    "270090", "270110", "270120", "270135", "270150", "270160", "270180", "270190", "270200", "270235", 
                                                    "270250", "270255", "270260", "270290", "270300", "270310", "270320", "270330", "270340", "270350", 
                                                    "270360", "270370", "270375", "270380", "270390", "270400", "270410", "270420", "270440", "270460", 
                                                    "270480", "270490", "270500", "270530", "270540", "270560", "270580", "270590", "270600", "270610", 
                                                    "270620", "270640", "270642", "270650", "270660", "270680", "270700", "270720", "270740", "270750", 
                                                    "270760", "270810", "270820", "270840", "270870", "270880", "270895", "270900", "270910", "270920", 
                                                    "280010", "280040", "280050", "280070", "280100", "280110", "280140", "280170", "280190", "280220", 
                                                    "280230", "280240", "280260", "280270", "280280", "280300", "280310", "280320", "280330", "280340", 
                                                    "280370", "280380", "280390", "280410", "280420", "280430", "280445", "280470", "280490", "280500", 
                                                    "280510", "280520", "280530", "280540", "280560", "280580", "280620", "280630", "280640", "280650", 
                                                    "280660", "280680", "280690", "280700", "280730", "280750", "290030", "290035", "290040", "290050", 
                                                    "290060", "290080", "290115", "290120", "290130", "290135", "290140", "290150",
                                                    "290160", "290170", "290180", "290190", "290195", "290200", "290205", "290210", "290220", "290225", "290230", "290250", "290260", "290265", "290280",
                                                    "290300", "290310", "290323", "290327", "290330", "290350", "290360", "290370", "290380", "290395", "290405", "290420", "290430", "290440", "290480",
                                                    "290485", "290510", "290515", "290530", "290540", "290550", "290580", "290590", "290610", "290620", "290640", "290660", "290680", "290682", "290685",
                                                    "290689", "290690", "290700", "290710", "290740", "290760", "290830", "290860", "290870", "290880", "290890", "290900", "290920", "290930", "290940",
                                                    "290950", "290960", "290970", "290990", "291000", "291010", "291020", "291030", "291070", "291075", "291085", "291090", "291100", "291125", "291130",
                                                    "291140", "291150", "291165", "291180", "291185", "291200", "291220", "291230", "291240", "291260", "291280", "291310", "291330", "291340", "291345",
                                                    "291370", "291380", "291420", "291430", "291440", "291450", "291490", "291500", "291535", "291540", "291590", "291620", "291630", "291650", "291670",
                                                    "291700", "291720", "291733", "291735", "291740", "291770", "291780", "291790", "291810", "291820", "291830", "291845", "291850", "291855", "291860",
                                                    "291870", "291875", "291880", "291890", "291900", "291905", "291910", "291930", "291940", "291950", "291960", "291995", "292000", "292010", "292020",
                                                    "292030", "292040", "292070", "292080", "292090", "292105", "292130", "292140", "292145", "292150", "292170", "292180", "292190", "292205", "292210",
                                                    "292220", "292225", "292240", "292260", "292265", "292270", "292273", "292275", "292280", "292285", "292290", "292305", "292330", "292335", "292340",
                                                    "292350", "292360", "292370", "292380", "292390", "292405", "292410", "292420", "292450", "292465", "292467", "292470", "292490", "292500", "292525",
                                                    "292540", "292550", "292560", "292570", "292575", "292580", "292590", "292593", "292595", "292610", "292620", "292640", "292650", "292665", "292670",
                                                    "292680", "292730", "292750", "292760", "292805", "292820", "292830", "292850", "292890", "292895", "292910", "292925", "292935", "292937", "292940",
                                                    "292960", "292970", "292975", "292980", "292990", "293000", "293015", "293020", "293030", "293040", "293060", "293075", "293076", "293080", "293090",
                                                    "293100", "293105", "293110", "293120", "293140", "293150", "293160", "293170", "293180", "293190", "293200", "293210", "293240", "293245", "293250",
                                                    "293260", "293305", "293310", "293315", "293317", "293325", "293340", "293345", "293350", "310010", "310030", "310040", "310050", "310060", "310070",
                                                    "310080", "310100", "310120", "310130", "310140", "310180", "310200", "310205", "310210", "310220", "310230", "310240", "310250", "310270", "310285",
                                                    "310300", "310310", "310320", "310330", "310360", "310370", "310380", "310440", "310445", "310450", "310460", "310470", "310480", "310500", "310520",
                                                    "310550", "310570", "310610", "310640", "310660", "310665", "310680", "310700", "310720", "310760", "310770", "310780", "310790", "310810", "310820",
                                                    "310840", "310850", "310870", "310880", "310890", "310910", "310920", "310945", "310950", "310960", "310970", "310980", "311010", "311020", "311030",
                                                    "311040", "311070", "311080", "311115", "311140", "311170", "311190", "311200", "311205", "311210", "311220", "311240", "311265", "311270", "311280",
                                                    "311290", "311300", "311310", "311350", "311360", "311380", "311390", "311400", "311410", "311460", "311470", "311480", "311490", "311500", "311520",
                                                    "311535", "311540", "311545", "311547", "311560", "311570", "311600", "311610", "311615", "311630", "311650", "311670", "311680", "311690", "311710",
                                                    "311720", "311740", "311750", "311760", "311810", "311820", "311850", "311870", "311880", "311890", "311900", "311920", "311960", "311980", "311995",
                                                    "312000", "312010", "312015", "312030", "312040", "312050", "312060", "312070", "312083", "312087", "312100", "312110", "312120", "312140", "312150",
                                                    "312170", "312180", "312190", "312200", "312210", "312220", "312245", "312247", "312260", "312270", "312280", "312310", "312330", "312340", "312350",
                                                    "312352", "312370", "312380", "312385", "312390", "312400", "312440", "312450", "312460", "312470", "312480", "312490", "312520", "312530", "312540",
                                                    "312550", "312570", "312580", "312590", "312595", "312600", "312620", "312640", "312660", "312675", "312680", "312695", "312705", "312707", "312720",
                                                    "312730", "312735", "312737", "312738", "312740", "312750", "312760", "312780", "312790", "312810", "312820", "312825", "312840", "312860", "312880",
                                                    "312900", "312910", "312920", "312930", "312940", "312960", "312965", "312970", "312990", "313000", "313005", "313020", "313030", "313055", "313060",
                                                    "313070", "313080", "313090", "313150", "313180", "313200", "313220", "313230", "313260", "313280", "313290", "313300", "313320", "313340", "313360",
                                                    "313370", "313390", "313400", "313410", "313450", "313460", "313470", "313480", "313505", "313507", "313530", "313535", "313545", "313550", "313560",
                                                    "313570", "313590", "313600", "313610", "313640", "313650", "313655", "313660", "313680", "313690", "313700", "313710", "313730", "313740", "313770",
                                                    "313790", "313800", "313810", "313830", "313835", "313850", "313860", "313865", "313867", "313868", "313870", "313910", "313925", "313970", "313990",
                                                    "314010", "314020", "314040",
                                                    "314050", "314053", "314060", "314085", "314100", "314120", "314130", "314150", "314160", "314170",
                                                    "314180", "314190", "314200", "314210", "314220", "314230", "314250", "314260", "314300", "314315",
                                                    "314345", "314350", "314360", "314370", "314380", "314400", "314420", "314437", "314440", "314465",
                                                    "314467", "314490", "314500", "314510", "314530", "314535", "314540", "314545", "314550", "314570",
                                                    "314580", "314585", "314587", "314620", "314625", "314640", "314650", "314655", "314660", "314670",
                                                    "314750", "314760", "314770", "314780", "314795", "314820", "314830", "314840", "314850", "314860",
                                                    "314875", "314880", "314890", "314900", "314910", "314915", "314920", "314940", "314950", "314960",
                                                    "314970", "314980", "314995", "315010", "315015", "315030", "315040", "315050", "315057", "315060",
                                                    "315080", "315170", "315190", "315213", "315217", "315220", "315230", "315240", "315260", "315270",
                                                    "315300", "315310", "315320", "315330", "315350", "315370", "315400", "315410", "315415", "315440",
                                                    "315445", "315450", "315490", "315500", "315520", "315530", "315550", "315570", "315590", "315600",
                                                    "315610", "315620", "315640", "315645", "315680", "315725", "315727", "315730", "315737", "315740",
                                                    "315750", "315760", "315765", "315790", "315800", "315810", "315820", "315830", "315840", "315850",
                                                    "315870", "315890", "315900", "315910", "315920", "315930", "315940", "315950", "315970", "316000",
                                                    "316020", "316030", "316045", "316050", "316060", "316095", "316100", "316105", "316120", "316140",
                                                    "316150", "316160", "316165", "316170", "316190", "316225", "316230", "316240", "316255", "316257",
                                                    "316260", "316265", "316270", "316280", "316294", "316300", "316310", "316330", "316340", "316350",
                                                    "316360", "316380", "316390", "316400", "316410", "316420", "316430", "316440", "316443", "316447",
                                                    "316450", "316460", "316480", "316490", "316500", "316510", "316520", "316540", "316550", "316555",
                                                    "316556", "316557", "316560", "316570", "316580", "316590", "316600", "316610", "316620", "316630",
                                                    "316640", "316650", "316660", "316680", "316695", "316700", "316710", "316730", "316740", "316760",
                                                    "316770", "316780", "316790", "316805", "316810", "316820", "316830", "316840", "316850", "316890",
                                                    "316905", "316910", "316920", "316950", "316980", "317000", "317005", "317030", "317043", "317047",
                                                    "317050", "317052", "317060", "317090", "317103", "317107", "317110", "317115", "317140", "317150",
                                                    "317170", "317180", "317190", "317210", "320010", "320013", "320016", "320030", "320035", "320040",
                                                    "320050", "320070", "320090", "320100", "320115", "320170", "320180", "320190", "320200", "320210",
                                                    "320225", "320255", "320260", "320265", "320270", "320290", "320310", "320316", "320330", "320334",
                                                    "320335", "320340", "320360", "320370", "320380", "320400", "320425", "320430", "320435", "320440",
                                                    "320450", "320455", "320460", "320465", "320480", "320495", "320503", "320506", "320515", "320517",
                                                    "330050", "330090", "330115", "330160", "330205", "330230", "330310", "330440", "330450", "330460",
                                                    "330475", "330513", "330515", "330530", "330540", "330560", "330570", "330590", "330615", "350020",
                                                    "350055", "350090", "350110", "350120", "350140", "350150", "350180", "350200", "350230", "350315",
                                                    "350335", "350340", "350350", "350395", "350430", "350490", "350500", "350535", "350540", "350620",
                                                    "350690", "350715", "350720", "350745", "350910", "350945", "350990", "351010", "351030", "351070",
                                                    "351090", "351160", "351270", "351290", "351330", "351385", "351390", "351420", "351480", "351490",
                                                    "351535", "351560", "351565", "351580", "351590", "351600", "351610", "351650", "351660", "351700",
                                                    "351710", "351720", "351760", "351800", "351830", "351850", "351905", "351925", "351970", "352020",
                                                    "352070", "352120", "352160", "352200", "352215", "352265", "352280", "352330", "352540", "352550",
                                                    "352560", "352585", "352610", "352620", "352630", "352725", "352750", "352780", "352790", "352820",
                                                    "352830", "352870", "352910", "352960", "352965", "352990", "353000", "353020", "353090", "353100",
                                                    "353200", "353210", "353215", "353230", "353240", "353260", "353282", "353284", "353286", "353310",
                                                    "353320", "353370", "353380", "353400", "353450", "353500", "353520", "353560", "353610", "353625",
                                                    "353640", "353657", "353680", "353690", "353715", "353720", "353750", "353780", "353820", "353830",
                                                    "353970", "354010", "354025", "354030", "354050", "354105", "354110", "354165", "354180", "354190",
                                                    "354250", "354280", "354300", "354320", "354323", "354325", "354350", "354360", "354440", "354470",
                                                    "354550", "354620", "354710", "354765", "354790", "354805", "354810", "354820", "354860", "354900",
                                                    "354920", "354925", "354930", "354960", "355000", "355050", "355080", "355110", "355120", "355130",
                                                    "355180", "355200", "355230", "355255", "355350", "355365", "355385", "355420", "355460", "355465",
                                                    "355475", "355495", "355520", "355530", "355550", "355570", "355590", "355635", "355695", "355715",
                                                    "410010", "410020", "410030", "410045", "410060", "410070", "410080", "410090", "410105", "410115",
                                                    "410130", "410165", "410170", "410185", "410250", "410270", "410275", "410290", "410300", "410302",
                                                    "410304", "410305", "410315", "410322", "410335", "410337", "410340", "410347", "410395", "410405",
                                                    "410410", "410440", "410442", "410445", "410450", "410470", "410500", "410520",
                                                    "410530", "410600", "410610", "410645", "410655", "410657", "410680", "410685", "410700", "410712",
                                                    "410715", "410725", "410740", "410750", "410752", "410753", "410754", "410755", "410773", "410775",
                                                    "410785", "410810", "410820", "410832", "410845", "410850", "410855", "410865", "410870", "410895",
                                                    "410900", "410910", "410920", "410930", "410950", "410965", "410975", "410990", "411005", "411007",
                                                    "411020", "411030", "411040", "411050", "411065", "411080", "411095", "411100", "411120", "411130",
                                                    "411140", "411155", "411160", "411170", "411220", "411230", "411250", "411260", "411275", "411290",
                                                    "411295", "411310", "411325", "411340", "411342", "411345", "411373", "411375", "411380", "411390",
                                                    "411400", "411435", "411440", "411450", "411490", "411530", "411535", "411540", "411545", "411550",
                                                    "411560", "411573", "411585", "411590", "411600", "411605", "411610", "411620", "411630", "411640",
                                                    "411650", "411660", "411670", "411680", "411695", "411705", "411720", "411721", "411722", "411725",
                                                    "411727", "411729", "411730", "411780", "411830", "411845", "411860", "411870", "411885", "411900",
                                                    "411910", "411920", "411925", "411965", "411970", "411980", "412010", "412015", "412020", "412030",
                                                    "412033", "412060", "412065", "412085", "412100", "412110", "412120", "412125", "412135", "412150",
                                                    "412160", "412170", "412175", "412180", "412200", "412210", "412215", "412217", "412250", "412265",
                                                    "412280", "412290", "412300", "412310", "412320", "412330", "412350", "412360", "412370", "412380",
                                                    "412382", "412385", "412390", "412395", "412400", "412420", "412430", "412470", "412480", "412500",
                                                    "412510", "412520", "412535", "412540", "412545", "412555", "412575", "412590", "412620", "412627",
                                                    "412635", "412665", "412667", "412670", "412690", "412700", "412750", "412760", "412780", "412785",
                                                    "412788", "412790", "412795", "412796", "412830", "412840", "412853", "412855", "412860", "412862",
                                                    "412863", "412865", "412870", "412880", "420005", "420010", "420020", "420040", "420050", "420055",
                                                    "420070", "420075", "420080", "420090", "420100", "420110", "420125", "420127", "420150", "420160",
                                                    "420165", "420170", "420180", "420190", "420195", "420205", "420208", "420209", "420213", "420215",
                                                    "420220", "420243", "420250", "420253", "420257", "420260", "420285", "420287", "420310", "420315",
                                                    "420325", "420330", "420340", "420350", "420370", "420400", "420410", "420415", "420417", "420419",
                                                    "420440", "420445", "420470", "420475", "420490", "420510", "420515", "420517", "420519", "420520",
                                                    "420530", "420535", "420543", "420555", "420560", "420580", "420610", "420640", "420660", "420675",
                                                    "420680", "420690", "420720", "420740", "420757", "420760", "420765", "420768", "420770", "420775",
                                                    "420780", "420785", "420790", "420800", "420810", "420840", "420845", "420850", "420860", "420870",
                                                    "420880", "420895", "420915", "420917", "420920", "420945", "420950", "420960", "420970", "420980",
                                                    "420985", "421000", "421005", "421020", "421030", "421040", "421055", "421060", "421070", "421080",
                                                    "421085", "421090", "421100", "421110", "421140", "421145", "421150", "421165", "421185", "421187",
                                                    "421189", "421200", "421205", "421210", "421220", "421223", "421227", "421240", "421260", "421270",
                                                    "421300", "421310", "421315", "421330", "421335", "421340", "421370", "421380", "421390", "421400",
                                                    "421410", "421415", "421420", "421430", "421440", "421450", "421460", "421470", "421490", "421505",
                                                    "421507", "421510", "421520", "421530", "421535", "421545", "421555", "421560", "421565", "421567",
                                                    "421568", "421569", "421575", "421590", "421600", "421610", "421625", "421635", "421640", "421670",
                                                    "421680", "421710", "421715", "421730", "421755", "421775", "421780", "421790", "421795", "421810",
                                                    "421825", "421840", "421850", "421860", "421875", "421880", "421885", "421890", "421895", "421910",
                                                    "421915", "421917", "421920", "421935", "421940", "421960", "430005", "430010", "430020", "430030",
                                                    "430045", "430047", "430050", "430055", "430057", "430063", "430064", "430066", "430070", "430080",
                                                    "430085", "430090", "430105", "430120", "430140", "430150", "430155", "430165", "430170", "430175",
                                                    "430180", "430185", "430187", "430190", "430192", "430195", "430200", "430205", "430215", "430220",
                                                    "430222", "430223", "430225", "430230", "430235", "430237", "430245", "430250", "430258", "430260",
                                                    "430265", "430290", "430320", "430330", "430340", "430355", "430360", "430367", "430370", "430380",
                                                    "430400", "430410", "430420", "430430", "430450", "430461", "430462", "430465", "430467", "430469",
                                                    "430471", "430485", "430490", "430495", "430500", "430511", "430512", "430513", "430515", "430517",
                                                    "430530", "430537", "430540", "430544", "430550", "430558", "430560", "430570", "430580", "430583",
                                                    "430585", "430587", "430590", "430593", "430595", "430597", "430600", "430605", "430607", "430613",
                                                    "430630", "430632", "430635", "430637", "430642", "430645", "430650", "430655", "430670", "430673",
                                                    "430675", "430692", "430695", "430697", "430705", "430710", "430720", "430730", "430740", "430745",
                                                    "430781", "430783", "430786", "430800", "430805", "430810", "430825", "430830", "430840", "430845",
                                                    "430870", "430880", "430885", "430912", "430915", "430925", "430950", "430955", "430957", "430970",
                                                    "430975", "430980", "430990", "430995", "431030", "431036", "431040", "431041",
                                                    "431043", "431046", "431050", "431055", "431057", "431065", "431070", "431075", "431085", "431087",
                                                    "431090", "431110", "431112", "431113", "431115", "431123", "431125", "431127", "431142", "431160",
                                                    "431164", "431170", "431173", "431177", "431179", "431190", "431198", "431200", "431205", "431210",
                                                    "431213", "431215", "431217", "431220", "431225", "431230", "431235", "431237", "431242", "431244",
                                                    "431245", "431250", "431260", "431261", "431262", "431267", "431275", "431280", "431290", "431295",
                                                    "431300", "431301", "431308", "431310", "431320", "431333", "431335", "431339", "431342", "431344",
                                                    "431346", "431349", "431360", "431365", "431380", "431395", "431400", "431402", "431403", "431406",
                                                    "431407", "431413", "431415", "431417", "431420", "431430", "431445", "431446", "431447", "431449",
                                                    "431450", "431454", "431455", "431460", "431470", "431475", "431477", "431478", "431500", "431505",
                                                    "431507", "431510", "431513", "431515", "431517", "431520", "431531", "431532", "431535", "431540",
                                                    "431545", "431550", "431555", "431575", "431580", "431590", "431595", "431610", "431620", "431630",
                                                    "431642", "431643", "431647", "431650", "431670", "431673", "431695", "431697", "431700", "431725",
                                                    "431755", "431760", "431770", "431775", "431790", "431795", "431805", "431842", "431843", "431844",
                                                    "431845", "431846", "431849", "431860", "431861", "431862", "431910", "431912", "431915", "431920",
                                                    "431930", "431935", "431936", "431937", "431970", "431971", "431973", "431975", "431980", "432020",
                                                    "432023", "432026", "432030", "432032", "432035", "432045", "432050", "432055", "432057", "432060",
                                                    "432065", "432067", "432085", "432132", "432135", "432140", "432146", "432147", "432149", "432162",
                                                    "432163", "432166", "432183", "432185", "432195", "432210", "432215", "432218", "432225", "432230",
                                                    "432232", "432234", "432235", "432237", "432252", "432253", "432255", "432285", "432290", "432310",
                                                    "432320", "432330", "432335", "432340", "432345", "432350", "432360", "432370", "432375", "432377",
                                                    "500020", "500080", "500085", "500090", "500124", "500150", "500230", "500260", "500310", "500315",
                                                    "500345", "500348", "500350", "500375", "500400", "500460", "500480", "500490", "500510", "500515",
                                                    "500525", "500580", "500625", "500627", "500730", "500750", "500755", "500780", "500797", "500800",
                                                    "500840", "510010", "510100", "510160", "510300", "510310", "510343", "510360", "510370", "510390",
                                                    "510395", "510490", "510520", "510523", "510590", "510610", "510682", "510685", "510700", "510719",
                                                    "510720", "510724", "510729", "510740", "510757", "510770", "510775", "510780", "510820", "510850",
                                                    "520010", "520015", "520017", "520020", "520050", "520055", "520060", "520082", "520090", "520120",
                                                    "520145", "520150", "520160", "520215", "520235", "520250", "520260", "520280", "520310", "520320",
                                                    "520340", "520357", "520380", "520393", "520396", "520400", "520420", "520425", "520460", "520465",
                                                    "520470", "520480", "520505", "520520", "520530", "520545", "520552", "520570", "520580", "520590",
                                                    "520630", "520650", "520660", "520670", "520680", "520690", "520710", "520725", "520735", "520750",
                                                    "520753", "520760", "520780", "520790", "520810", "520815", "520830", "520929", "520940", "520945",
                                                    "520960", "520980", "520990", "521015", "521030", "521080", "521100", "521130", "521140", "521160",
                                                    "521170", "521200", "521205", "521210", "521225", "521230", "521260", "521270", "521280", "521290",
                                                    "521295", "521305", "521340", "521350", "521370", "521377", "521385", "521390", "521405", "521410",
                                                    "521440", "521470", "521480", "521483", "521486", "521487", "521490", "521520", "521525", "521530",
                                                    "521540", "521565", "521580", "521590", "521600", "521640", "521645", "521680", "521690", "521720",
                                                    "521805", "521810", "521839", "521878", "521920", "521925", "521935", "521945", "521950", "521960",
                                                    "521970", "521971", "521980", "521990", "522000", "522005", "522015", "522026", "522028", "522070",
                                                    "522100", "522108", "522145", "522150", "522155", "522157", "522170", "522180", "522190", "522200",
                                                    "522220", "522230"), 2,
                                   ifelse(CODMUNRES %in% c("110045", "120010", "120025", "120030", "120060", "130014", "130040", "130060", "130070", "130130",
                                                           "130140", "130150", "130160", "130230", "130240", "130330", "130370", "130380", "130410", "150050",
                                                           "150215", "150390", "150503", "150580", "150640", "150815", "160010", "160050", "170040", "170330",
                                                           "170555", "171650", "172125", "210180", "210800", "210830", "220290", "221120", "260740", "291320",
                                                           "312560", "313580", "313930", "430543", "500210", "500560", "510040", "510060", "510140", "510270",
                                                           "510335", "510345", "510350", "510410", "510510", "510630", "510642", "510860", "520547", "522020"), 3,
                                          ifelse(CODMUNRES %in% c("110001", "110006", "110009", "110025", "110094", "120045", "120050", "130185", "130200", "150013",
                                                                  "150275", "150295", "150309", "150320", "150330", "150460", "150506", "150611", "150660", "150715",
                                                                  "150745", "150747", "160023", "160053", "170035", "170070", "170100", "170110", "170220", "170230",
                                                                  "170290", "170310", "170380", "170770", "170820", "171320", "171880", "172110", "172210", "210030",
                                                                  "210100", "210203", "210270", "210280", "210350", "210370", "210380", "210455", "210467", "210542",
                                                                  "210550", "210620", "210735", "210850", "210870", "210880", "211000", "211003", "211050", "211070",
                                                                  "211153", "211160", "211210", "211260", "211270", "211280", "211290", "220230", "220260", "220370",
                                                                  "220450", "220460", "220550", "220580", "220595", "220600", "220700", "220780", "220790", "220830",
                                                                  "221000", "221060", "230015", "230210", "230270", "230380", "230495", "230540", "230580", "230690",
                                                                  "230790", "230870", "230930", "230950", "231020", "231050", "231070", "231150", "231160", "231310",
                                                                  "231330", "231380", "231395", "231400", "240010", "240080", "240100", "240140", "240145", "240170",
                                                                  "240180", "240185", "240230", "240240", "240300", "240340", "240485", "240490", "240500", "240540",
                                                                  "240570", "240580", "240670", "240720", "240760", "240770", "240820", "240830", "240930", "241100",
                                                                  "241160", "241190", "241210", "241220", "241240", "241250", "241260", "241450", "241470", "250030",
                                                                  "250110", "250250", "250430", "250440", "250480", "250520", "250600", "250680", "250710", "250760",
                                                                  "250880", "250915", "250930", "250970", "251130", "251140", "251180", "251230", "251490", "251630",
                                                                  "251690", "260030", "260040", "260050", "260070", "260080", "260110", "260150", "260160", "260230",
                                                                  "260300", "260440", "260450", "260510", "260550", "260570", "260590", "260610", "260660", "260730",
                                                                  "260810", "260845", "260875", "260900", "260990", "261100", "261130", "261190", "261300", "261310",
                                                                  "261330", "261360", "261380", "261410", "261420", "261460", "261485", "261500", "261630", "270020",
                                                                  "270070", "270170", "270270", "270570", "270710", "270780", "270830", "270850", "280020", "280067",
                                                                  "280120", "280130", "280160", "280450", "280460", "280550", "280600", "280710", "280760", "290090",
                                                                  "290100", "290110", "290240", "290290", "290340", "290470", "290500", "290520", "290560", "290600",
                                                                  "290670", "290730", "290780", "290790", "290820", "291040", "291050", "291060", "291110", "291190",
                                                                  "291210", "291270", "291290", "291350", "291400", "291510", "291520", "291530", "291550", "291570",
                                                                  "291600", "291660", "291685", "291690", "291730", "291835", "291915", "292050", "292060", "292110",
                                                                  "292120", "292200", "292310", "292460", "292480", "292600", "292630", "292700", "292710", "292720",
                                                                  "292770", "292780", "292790", "292800", "292840", "292880", "292930", "293130", "293220", "293230",
                                                                  "293270", "293280", "293300", "310090", "310110", "310280", "310340", "310390", "310410", "310530",
                                                                  "310750", "310830", "310860", "310930", "311050", "311060", "311090", "311100", "311110", "311130",
                                                                  "311160", "311230", "311320", "311330", "311370", "311420", "311440", "311450", "311580", "311780",
                                                                  "311790", "311840", "311930", "311990", "312020", "312125", "312130", "312235", "312240", "312250",
                                                                  "312290", "312300", "312420", "312430", "312510", "312670", "312690", "312800", "312890", "313050",
                                                                  "313140", "313160", "313250", "313270", "313330", "313350", "313490", "313750", "313753", "313780",
                                                                  "313890", "313920", "313960", "314055", "314070", "314090", "314140", "314240", "314280", "314290",
                                                                  "314320", "314340", "314450", "314460", "314470", "314600", "314630", "315000", "315020", "315053",
                                                                  "315070", "315110", "315130", "315280", "315290", "315340", "315420", "315430", "315540", "315710",
                                                                  "315770", "315880", "315935", "315980", "316010", "316080", "316130", "316180", "316220", "316530",
                                                                  "316670", "316690", "316970", "317057", "317075", "320020", "320080", "320140", "320160", "320230",
                                                                  "320245", "320250", "320280", "320300", "320305", "320313", "320332", "320350", "320405", "320410",
                                                                  "320470", "320501", "330015", "330180", "330210", "330245", "330280", "330380", "330400", "330410",
                                                                  "330415", "330480", "330620", "350050", "350060", "350220", "350260", "350270", "350275", "350300",
                                                                  "350310", "350360", "350370", "350440", "350470", "350510", "350630", "350640", "350680", "350730",
                                                                  "350820", "350830", "350870", "350925", "350930", "350980", "351080", "351100", "351190", "351230",
                                                                  "351260", "351360", "351400", "351430", "351460", "351470", "351519", "351520", "351680", "351690",
                                                                  "351730", "351780", "351790", "351810", "351885", "351890", "351900", "351910", "351920", "351940",
                                                                  "351950", "351980", "351990", "352030", "352042", "352150", "352170", "352300", "352380", "352420",
                                                                  "352460", "352580", "352650", "352700", "352770", "352810", "352860", "352880", "352950", "353160",
                                                                  "353205", "353270", "353290", "353330", "353360", "353420", "353475", "353480", "353570", "353580",
                                                                  "353590", "353600", "353620", "353660", "353700", "353770", "353790", "353860", "353900", "353960",
                                                                  "353990", "354040", "354200", "354290", "354380", "354420", "354460", "354480", "354490", "354510",
                                                                  "354540", "354570", "354650", "354700", "354840", "354950", "355020", "355040", "355160", "355210",
                                                                  "355300", "355310", "355320", "355440", "355470", "355535", "355580", "355610",
                                                                  "355690", "355720", "410050", "410120", "410200", "410220", "410260", "410320", "410330", "410350",
                                                                  "410390", "410460", "410510", "410540", "410560", "410630", "410650", "410710", "410730", "410770",
                                                                  "410780", "410800", "410890", "410960", "410970", "411010", "411060", "411090", "411240", "411280",
                                                                  "411300", "411330", "411360", "411500", "411510", "411575", "411700", "411770", "411800", "411890",
                                                                  "411930", "411940", "411960", "412035", "412050", "412070", "412090", "412130", "412140", "412260",
                                                                  "412270", "412340", "412440", "412450", "412460", "412490", "412530", "412560", "412570", "412580",
                                                                  "412600", "412610", "412630", "412640", "412660", "412730", "412740", "420207", "420390", "420500",
                                                                  "420550", "421105", "421170", "421180", "421320", "421540", "421605", "421650", "421690", "421700",
                                                                  "421750", "421770", "421830", "421985", "430163", "430280", "430520", "430545", "430690", "430750",
                                                                  "430820", "430900", "431000", "431150", "431175", "431270", "431303", "431570", "431600", "431645",
                                                                  "431660", "431810", "431820", "431850", "431880", "431940", "431960", "432100", "432145", "432190",
                                                                  "500060", "500200", "500240", "500450", "500470", "500600", "500710", "500720", "510267", "510305",
                                                                  "510330", "510420", "510455", "510637", "510650", "510710", "520030", "520085", "520130", "520330",
                                                                  "520390", "520410", "520440", "520485", "520495", "520500", "520551", "520640", "520740", "520840",
                                                                  "520890", "520915", "520993", "521056", "521060", "521220", "521375", "521630", "521710", "521730",
                                                                  "521830", "521870", "521900", "521910", "522050", "522060", "522119", "522205", "421265"), 4,
                                                 ifelse(CODMUNRES %in% c("110002", "110004", "110005", "110010", "110011", "110012", "110015", "110018", "110020", "110028",
                                                                         "110030", "110080", "120020", "120040", "130100", "130120", "130170", "130190", "130250", "130260",
                                                                         "130340", "130406", "130420", "140010", "150010", "150040", "150060", "150080", "150130", "150140",
                                                                         "150150", "150170", "150178", "150180", "150210", "150220", "150240", "150270", "150277", "150293",
                                                                         "150360", "150370", "150380", "150405", "150420", "150442", "150480", "150510", "150530", "150543",
                                                                         "150550", "150553", "150613", "150616", "150618", "150620", "150650", "150670", "150680", "150730",
                                                                         "150760", "150790", "150795", "150797", "150800", "150808", "150810", "150812", "150820", "150840",
                                                                         "160027", "160030", "160060", "170030", "170210", "170255", "170550", "170700", "170930", "170950",
                                                                         "171330", "171610", "171820", "172100", "172120", "210005", "210043", "210120", "210140", "210150",
                                                                         "210160", "210230", "210232", "210255", "210290", "210300", "210320", "210330", "210340", "210360",
                                                                         "210375", "210405", "210480", "210530", "210540", "210570", "210632", "210675", "210750", "210770",
                                                                         "210820", "210860", "210900", "210910", "210945", "210960", "210980", "210990", "211110", "211120",
                                                                         "211130", "211150", "211220", "211223", "211245", "211400", "220020", "220040", "220190", "220220",
                                                                         "220390", "220770", "220800", "220840", "220880", "221100", "221130", "230100", "230110", "230190",
                                                                         "230250", "230260", "230280", "230350", "230370", "230410", "230420", "230428", "230435", "230440",
                                                                         "230523", "230550", "230625", "230630", "230640", "230730", "230760", "230765", "230770", "230960",
                                                                         "230970", "231130", "231140", "231180", "231290", "231340", "240020", "240110", "240200", "240220",
                                                                         "240260", "240310", "240325", "240360", "240420", "240560", "240710", "240800", "240810", "240890",
                                                                         "240940", "241120", "241200", "241230", "250060", "250150", "250180", "250300", "250320", "250370",
                                                                         "250400", "250460", "250510", "250630", "250690", "250700", "250750", "250790", "250830", "250860",
                                                                         "250890", "250910", "250920", "251010", "251080", "251120", "251170", "251210", "251240", "251250",
                                                                         "251260", "251270", "251290", "251340", "251370", "251390", "251530", "251600", "251620", "260005",
                                                                         "260010", "260090", "260105", "260120", "260130", "260140", "260170", "260190", "260210", "260260",
                                                                         "260290", "260310", "260345", "260350", "260360", "260400", "260410", "260420", "260460", "260500",
                                                                         "260520", "260540", "260600", "260620", "260640", "260680", "260720", "260760", "260765", "260775",
                                                                         "260780", "260790", "260820", "260850", "260880", "260890", "260940", "260950", "260960", "261000",
                                                                         "261060", "261070", "261090", "261110", "261160", "261180", "261220", "261250", "261340", "261370",
                                                                         "261390", "261450", "261530", "261540", "261550", "261560", "261640", "270030", "270040", "270050",
                                                                         "270100", "270130", "270140", "270210", "270220", "270230", "270240", "270280", "270430", "270450",
                                                                         "270470", "270510", "270520", "270550", "270630", "270644", "270670", "270690", "270730", "270770",
                                                                         "270790", "270800", "270860", "270890", "270915", "270930", "270940", "280030", "280060", "280150",
                                                                         "280200", "280210", "280250", "280290", "280350", "280360", "280400", "280440", "280480", "280570",
                                                                         "280590", "280610", "280670", "280720", "280740", "290070", "290320", "290390", "290460", "290490",
                                                                         "290570", "290630", "290650", "290687", "290720", "290750", "290800", "290840", "290850", "290980",
                                                                         "291005", "291072", "291080", "291120", "291160", "291170", "291360", "291390", "291460", "291465",
                                                                         "291470", "291480", "291560", "291580", "291610", "291640", "291680", "291710", "291750", "291760",
                                                                         "291800", "291840", "291920", "291955", "291970", "291992", "292100", "292230", "292250", "292300",
                                                                         "292400", "292510", "292520", "292530", "292660", "292740", "292810", "292860", "292870", "292900",
                                                                         "292905", "292920", "292950", "293010", "293050", "293070", "293077", "293135", "293290", "293320",
                                                                         "293330", "293360", "310020", "310150", "310160", "310163", "310170", "310190", "310260", "310290",
                                                                         "310350", "310375", "310400", "310420", "310430", "310490", "310510", "310540", "310560", "310590",
                                                                         "310600", "310620", "310630", "310670", "310690", "310710", "310730", "310740", "310800", "310855",
                                                                         "310900", "310925", "310940", "310990", "311000", "311120", "311150", "311180", "311250", "311260",
                                                                         "311340", "311430", "311510", "311530", "311550", "311590", "311620", "311640", "311660", "311730",
                                                                         "311770", "311787", "311800", "311830", "311860", "311910", "311940", "311970", "312080", "312090",
                                                                         "312160", "312230", "312320", "312360", "312410", "312500", "312610", "312630", "312700", "312710",
                                                                         "312770", "312830", "312850", "312870", "312950", "312980", "313010", "313040", "313100", "313110",
                                                                         "313115", "313120", "313130", "313170", "313190", "313210", "313240", "313310", "313375", "313380",
                                                                         "313420", "313430", "313440", "313500", "313510", "313520", "313540", "313620", "313630", "313665",
                                                                         "313670", "313720", "313760", "313820", "313840", "313880", "313900", "313940", "313950", "313980",
                                                                         "314000", "314015", "314030", "314080", "314110", "314310", "314330", "314390", "314410", "314430",
                                                                         "314435", "314480", "314505", "314520", "314560", "314590", "314610", "314690", "314700", "314710",
                                                                         "314720", "314730", "314740", "314790", "314800", "314810", "314870", "314930", "314990",
                                                                         "315090", "315100", "315120", "315140", "315150", "315160", "315180", "315200", "315210", "315250",
                                                                         "315360", "315380", "315390", "315460", "315470", "315480", "315580", "315630", "315670", "315690",
                                                                         "315700", "315720", "315733", "315780", "315860", "315895", "315960", "315990", "316040", "316070",
                                                                         "316090", "316110", "316200", "316210", "316250", "316290", "316292", "316295", "316320", "316370",
                                                                         "316470", "316553", "316720", "316750", "316800", "316860", "316870", "316880", "316900", "316930",
                                                                         "316935", "316940", "316960", "316990", "317010", "317020", "317040", "317070", "317080", "317100",
                                                                         "317120", "317130", "317200", "317220", "320060", "320110", "320120", "320130", "320150", "320220",
                                                                         "320240", "320320", "320390", "320420", "320490", "320500", "320510", "320520", "320530", "330010",
                                                                         "330020", "330022", "330023", "330025", "330030", "330040", "330045", "330060", "330070", "330080",
                                                                         "330093", "330095", "330100", "330110", "330120", "330130", "330140", "330150", "330170", "330185",
                                                                         "330187", "330190", "330200", "330220", "330225", "330227", "330240", "330250", "330260", "330270",
                                                                         "330285", "330290", "330300", "330320", "330330", "330340", "330350", "330360", "330370", "330385",
                                                                         "330390", "330395", "330411", "330412", "330414", "330420", "330430", "330452", "330455", "330470",
                                                                         "330490", "330500", "330510", "330520", "330550", "330555", "330575", "330580", "330600", "330610",
                                                                         "330630", "350010", "350030", "350040", "350070", "350075", "350080", "350100", "350115", "350130",
                                                                         "350160", "350170", "350190", "350210", "350240", "350250", "350280", "350290", "350320", "350330",
                                                                         "350380", "350390", "350400", "350410", "350420", "350450", "350460", "350480", "350520", "350530",
                                                                         "350550", "350560", "350570", "350580", "350590", "350600", "350610", "350635", "350650", "350660",
                                                                         "350670", "350700", "350710", "350740", "350750", "350760", "350770", "350775", "350780", "350790",
                                                                         "350800", "350810", "350840", "350850", "350860", "350880", "350890", "350900", "350920", "350940",
                                                                         "350950", "350960", "350970", "350995", "351000", "351015", "351020", "351040", "351050", "351060",
                                                                         "351110", "351120", "351130", "351140", "351150", "351170", "351200", "351210", "351220", "351240",
                                                                         "351250", "351280", "351300", "351310", "351320", "351340", "351350", "351370", "351380", "351410",
                                                                         "351440", "351450", "351492", "351495", "351500", "351510", "351512", "351515", "351518", "351530",
                                                                         "351540", "351550", "351570", "351620", "351630", "351640", "351670", "351685", "351740", "351750",
                                                                         "351770", "351820", "351840", "351860", "351870", "351880", "351907", "351930", "351960", "352000",
                                                                         "352010", "352040", "352044", "352050", "352060", "352080", "352090", "352100", "352110", "352115",
                                                                         "352130", "352140", "352180", "352190", "352210", "352220", "352230", "352240", "352250", "352260",
                                                                         "352270", "352290", "352310", "352320", "352340", "352350", "352360", "352370", "352390", "352400",
                                                                         "352410", "352430", "352440", "352450", "352470", "352480", "352490", "352500", "352510", "352520",
                                                                         "352530", "352570", "352590", "352600", "352640", "352660", "352670", "352680", "352690", "352710",
                                                                         "352720", "352730", "352740", "352760", "352800", "352840", "352850", "352885", "352890", "352900",
                                                                         "352920", "352930", "352940", "352970", "352980", "353010", "353030", "353040", "353050", "353060",
                                                                         "353070", "353080", "353110", "353120", "353130", "353140", "353150", "353170", "353180", "353190",
                                                                         "353220", "353250", "353280", "353300", "353325", "353340", "353350", "353390", "353410", "353430",
                                                                         "353440", "353460", "353470", "353490", "353510", "353530", "353540", "353550", "353630", "353650",
                                                                         "353670", "353710", "353730", "353740", "353760", "353800", "353810", "353850", "353870", "353880",
                                                                         "353890", "353910", "353920", "353930", "353940", "353950", "353980", "354000", "354020", "354060",
                                                                         "354070", "354075", "354080", "354085", "354090", "354100", "354120", "354130", "354140", "354150",
                                                                         "354160", "354170", "354210", "354220", "354230", "354240", "354260", "354270", "354310", "354330",
                                                                         "354340", "354370", "354390", "354400", "354410", "354425", "354430", "354450", "354500", "354515",
                                                                         "354520", "354530", "354560", "354580", "354600", "354610", "354625", "354630", "354640", "354660",
                                                                         "354670", "354680", "354690", "354720", "354730", "354740", "354750", "354760", "354770", "354780",
                                                                         "354800", "354830", "354850", "354870", "354880", "354890", "354910", "354940", "354970", "354980",
                                                                         "354990", "354995", "355010", "355030", "355060", "355070", "355090", "355100", "355140", "355150",
                                                                         "355170", "355190", "355220", "355240", "355250", "355260", "355270", "355280", "355290", "355330",
                                                                         "355340", "355360", "355370", "355380", "355390", "355395", "355400", "355410", "355430", "355450",
                                                                         "355480", "355490", "355500", "355510", "355540", "355560", "355600", "355620", "355630", "355640",
                                                                         "355645", "355650", "355660", "355670", "355680", "355700", "355710", "355730", "410040", "410100",
                                                                         "410110", "410140", "410150", "410160", "410180", "410190", "410210", "410230", "410240", "410280",
                                                                         "410310", "410345", "410360", "410370", "410380", "410400", "410420", "410425", "410430", "410465",
                                                                         "410480", "410490", "410550", "410570", "410580", "410590", "410620", "410640", "410660", "410670",
                                                                         "410690", "410720", "410760", "410765", "410790", "410830", "410840", "410860",
                                                                         "410880", "410940", "410980", "411000", "411070", "411110", "411125", "411150", "411180", "411190",
                                                                         "411200", "411210", "411270", "411320", "411350", "411370", "411410", "411420", "411430", "411460",
                                                                         "411470", "411480", "411520", "411570", "411580", "411690", "411710", "411740", "411745", "411750",
                                                                         "411760", "411790", "411810", "411820", "411840", "411850", "411880", "411915", "411950", "411990",
                                                                         "411995", "412000", "412040", "412080", "412190", "412220", "412230", "412240", "412402", "412405",
                                                                         "412410", "412550", "412625", "412650", "412680", "412710", "412720", "412770", "412800", "412810",
                                                                         "412820", "412850", "420030", "420060", "420120", "420130", "420140", "420200", "420210", "420230",
                                                                         "420240", "420245", "420270", "420280", "420290", "420300", "420320", "420360", "420380", "420395",
                                                                         "420420", "420425", "420430", "420435", "420450", "420455", "420460", "420480", "420540", "420545",
                                                                         "420570", "420590", "420600", "420620", "420630", "420650", "420665", "420670", "420700", "420710",
                                                                         "420730", "420750", "420820", "420830", "420890", "420900", "420910", "420930", "420940", "420990",
                                                                         "421003", "421010", "421050", "421120", "421125", "421130", "421160", "421175", "421190", "421225",
                                                                         "421230", "421250", "421280", "421290", "421350", "421360", "421480", "421500", "421550", "421570",
                                                                         "421580", "421620", "421630", "421660", "421720", "421725", "421740", "421760", "421800", "421820",
                                                                         "421835", "421870", "421900", "421930", "421950", "421970", "422000", "430003", "430040", "430060",
                                                                         "430087", "430100", "430107", "430110", "430130", "430160", "430210", "430240", "430270", "430300",
                                                                         "430310", "430350", "430390", "430435", "430440", "430460", "430463", "430466", "430468", "430470",
                                                                         "430480", "430510", "430535", "430610", "430620", "430640", "430660", "430676", "430680", "430693",
                                                                         "430700", "430755", "430760", "430770", "430780", "430790", "430807", "430843", "430850", "430860",
                                                                         "430890", "430905", "430910", "430920", "430930", "430940", "430960", "430965", "431010", "431020",
                                                                         "431033", "431053", "431060", "431080", "431100", "431120", "431130", "431140", "431162", "431180",
                                                                         "431238", "431240", "431247", "431265", "431306", "431330", "431337", "431340", "431350", "431370",
                                                                         "431390", "431405", "431410", "431440", "431442", "431480", "431490", "431514", "431530", "431560",
                                                                         "431640", "431675", "431680", "431690", "431710", "431720", "431730", "431740", "431750", "431780",
                                                                         "431800", "431830", "431840", "431848", "431870", "431890", "431900", "431950", "431990", "432000",
                                                                         "432010", "432040", "432070", "432080", "432090", "432110", "432120", "432130", "432143", "432150",
                                                                         "432160", "432170", "432180", "432200", "432220", "432240", "432250", "432254", "432260", "432270",
                                                                         "432280", "432300", "432380", "500070", "500100", "500110", "500190", "500220", "500270", "500290",
                                                                         "500295", "500320", "500325", "500330", "500370", "500380", "500410", "500500", "500520", "500540",
                                                                         "500568", "500570", "500620", "500630", "500660", "500740", "500769", "500790", "500793", "500830",
                                                                         "510020", "510025", "510030", "510125", "510130", "510170", "510180", "510250", "510263", "510320",
                                                                         "510340", "510480", "510515", "510525", "510562", "510600", "510622", "510623", "510625", "510665",
                                                                         "510675", "510704", "510730", "510760", "510787", "510790", "510792", "510795", "510840", "520005",
                                                                         "520013", "520025", "520080", "520110", "520140", "520170", "520180", "520350", "520355", "520360",
                                                                         "520430", "520450", "520455", "520490", "520510", "520540", "520549", "520620", "520800", "520850",
                                                                         "520860", "520870", "520880", "520910", "520920", "520970", "520995", "521000", "521010", "521020",
                                                                         "521040", "521090", "521120", "521150", "521180", "521190", "521250", "521300", "521308", "521310",
                                                                         "521380", "521400", "521450", "521460", "521500", "521523", "521550", "521560", "521570", "521740",
                                                                         "521760", "521770", "521800", "521850", "521860", "521880", "521890", "521930", "521940", "521973",
                                                                         "521975", "522010", "522040", "522045", "522068", "522130", "522140", "522160", "522185", "530010"), 5, 999))))))

base_2 %>% mutate_at(vars("TIPOLOGIA"), ~replace_na(.,999))#tranformei os NA em 999
base_2 <- base_2 %>% mutate_at(vars("TIPOLOGIA"), ~replace_na(.,999)) #criei um df
base_2 %>% colnames # verificando as variaveis
base_2$TIPOLOGIA %>% table (useNA = "always") # verificando NA
base_2 %>% relocate(TIPOLOGIA, .after = "MACRORREGIAO") #realocando a nova variavel ao lado da antiga
base_2 <- base_2 %>% relocate(TIPOLOGIA, .after = "MACRORREGIAO") #atribui um objeto a mudança
base_2%>% colnames # verificando as variaveis 

#dando nome
base_2 <- base_2 %>% mutate(TIPOLOGIA = case_when(
  TIPOLOGIA == 1 ~ "Rural remoto",
  TIPOLOGIA == 2 ~ "Rural adjacente",
  TIPOLOGIA == 3 ~ "Intermediario remoto",
  TIPOLOGIA == 4 ~ "Intermediario adjacente",
  TIPOLOGIA == 5 ~ "Urbano",
  TRUE ~ "999"))
base_2$TIPOLOGIA <- as.factor(base_2$TIPOLOGIA)

##Assistmed -----

base_2$ASSISTMED %>% glimpse
base_2$ASSISTMED %>% table (useNA = "always")# 1 com assistencia 2 sem assistencia 9 e NA transformado em ignorado
base_2$ASSISTMED_NOVO <- ifelse(base_2$ASSISTMED == 1,1,
                             ifelse (base_2$ASSISTMED == 2,2, 999))
base_2 %>% mutate_at(vars("ASSISTMED_NOVO"), ~replace_na(.,999))#tranformei os NA em 999
base_2 <- base_2 %>% mutate_at(vars("ASSISTMED_NOVO"), ~replace_na(.,999)) #criei um df
base_2 %>% colnames # verificando as variaveis
base_2$ASSISTMED_NOVO %>% table (useNA = "always") # verificando NA
base_2$ASSISTMED %>% table(useNA = "always")
base_2 %>% relocate(ASSISTMED_NOVO, .after = "ASSISTMED") #realocando a nova variavel ao lado da antiga
base_2 <- base_2 %>% relocate(ASSISTMED_NOVO, .after = "ASSISTMED") #atribui um objeto a mudança
base_2 %>% colnames
#dando nome
base_2 <- base_2 %>% mutate(ASSISTMED_NOVO = case_when(
  ASSISTMED == 1 ~ "Sim",
  ASSISTMED == 2 ~ "Não",
  TRUE ~ "999"))
base_2$ASSISTMED_NOVO <- as.factor(base_2$ASSISTMED_NOVO)

##Exames -----

base_2$EXAME %>% glimpse
base_2$EXAME %>% table (useNA = "always")# 1 SIM 2 NAO 9 e NA transformado em ignorado
base_2$EXAME_NOVO <- ifelse(base_2$EXAME == 1,1,
                                ifelse (base_2$EXAME == 2,2, 999))
base_2 %>% mutate_at(vars("EXAME_NOVO"), ~replace_na(.,999))#tranformei os NA em 999
base_2 <- base_2 %>% mutate_at(vars("EXAME_NOVO"), ~replace_na(.,999)) #criei um df
base_2 %>% colnames # verificando as variaveis
base_2$EXAME_NOVO %>% table (useNA = "always") # verificando NA
base_2$EXAME %>% table(useNA = "always")
base_2 %>% relocate(EXAME_NOVO, .after = "EXAME") #realocando a nova variavel ao lado da antiga
base_2 <- base_2 %>% relocate(EXAME_NOVO, .after = "EXAME") #atribui um objeto a mudan?a
base_2 %>% colnames

#dando nome
base_2 <- base_2 %>% mutate(EXAME_NOVO = case_when(
  EXAME == 1 ~ "Sim",
 EXAME == 2 ~ "Não",
  TRUE ~ "999"))
base_2$EXAME_NOVO <- as.factor(base_2$EXAME_NOVO)

##Causabas -----

base_2$CAUSABAS %>% glimpse
base_2$CAUSABAS_BAS_CAP <- ifelse((substr(base_2$CAUSABAS,1,3) >= "A00") & (substr(base_2$CAUSABAS,1,3) <= "B99"),1,
                                      ifelse((substr(base_2$CAUSABAS,1,3) >= "C00") & (substr(base_2$CAUSABAS,1,3) <= "D48"),2,
                                             ifelse((substr(base_2$CAUSABAS,1,3) >= "D50") & (substr(base_2$CAUSABAS,1,3) <= "D89"),3,
                                                    ifelse((substr(base_2$CAUSABAS,1,3) >= "E00") & (substr(base_2$CAUSABAS,1,3) <= "E90"),4,
                                                           ifelse((substr(base_2$CAUSABAS,1,3) >= "F00") & (substr(base_2$CAUSABAS,1,3) <= "F99"),5,
                                                                  ifelse((substr(base_2$CAUSABAS,1,3) >= "G00") & (substr(base_2$CAUSABAS,1,3) <= "G99"),6,
                                                                         ifelse((substr(base_2$CAUSABAS,1,3) >= "H00") & (substr(base_2$CAUSABAS,1,3) <= "H59"),7,
                                                                                ifelse((substr(base_2$CAUSABAS,1,3) >= "H60") & (substr(base_2$CAUSABAS,1,3) <= "H95"),8,
                                                                                       ifelse((substr(base_2$CAUSABAS,1,3) >= "I00") & (substr(base_2$CAUSABAS,1,3) <= "I99"),9,
                                                                                              ifelse((substr(base_2$CAUSABAS,1,3) >= "J00") & (substr(base_2$CAUSABAS,1,3) <= "J99"),10,
                                                                                                     ifelse((substr(base_2$CAUSABAS,1,3) >= "K00") & (substr(base_2$CAUSABAS,1,3) <= "K93"),11,
                                                                                                            ifelse((substr(base_2$CAUSABAS,1,3) >= "L00") & (substr(base_2$CAUSABAS,1,3) <= "L99"),12,
                                                                                                                   ifelse((substr(base_2$CAUSABAS,1,3) >= "M00") & (substr(base_2$CAUSABAS,1,3) <= "M99"),13,
                                                                                                                          ifelse((substr(base_2$CAUSABAS,1,3) >= "N00") & (substr(base_2$CAUSABAS,1,3) <= "N99"),14,
                                                                                                                                 ifelse((substr(base_2$CAUSABAS,1,3) >= "O00") & (substr(base_2$CAUSABAS,1,3) <= "O99"),15,
                                                                                                                                        ifelse((substr(base_2$CAUSABAS,1,3) >= "P00") & (substr(base_2$CAUSABAS,1,3) <= "P96"),16,
                                                                                                                                               ifelse((substr(base_2$CAUSABAS,1,3) >= "Q00") & (substr(base_2$CAUSABAS,1,3) <= "Q99"),17,
                                                                                                                                                      ifelse((substr(base_2$CAUSABAS,1,3) >= "R00") & (substr(base_2$CAUSABAS,1,3) <= "R99"),18,
                                                                                                                                                             ifelse((substr(base_2$CAUSABAS,1,3) >= "S00") & (substr(base_2$CAUSABAS,1,3) <= "T98"),19,
                                                                                                                                                                    ifelse((substr(base_2$CAUSABAS,1,3) >= "V01") & (substr(base_2$CAUSABAS,1,3) <= "Y98"),20,999))))))))))))))))))))
base_2 %>% mutate_at(vars("CAUSABAS_BAS_CAP"), ~replace_na(.,999))#tranformei os NA em 999
base_2 <- base_2 %>% mutate_at(vars("CAUSABAS_BAS_CAP"), ~replace_na(.,999)) #criei um df
base_2 %>% colnames # verificando as variaveis
base_2$CAUSABAS_BAS_CAP %>% table (useNA = "always") # verificando NA
base_2$CAUSABAS %>% table(useNA = "always")

# Criando uma nova coluna para o capitulo XI somente

base_2$CAUSABAS_DOEN_DIG <- ifelse((substr(base_2$CAUSABAS,1,3) >= "K00") & (substr(base_2$CAUSABAS,1,3) <= "K14"),1,
                                       ifelse((substr(base_2$CAUSABAS,1,3) >= "K20") & (substr(base_2$CAUSABAS,1,3) <= "K31"),2,
                                              ifelse((substr(base_2$CAUSABAS,1,3) >= "K35") & (substr(base_2$CAUSABAS,1,3) <= "K38"),3,
                                                     ifelse((substr(base_2$CAUSABAS,1,3) >= "K40") & (substr(base_2$CAUSABAS,1,3) <= "K46"),4,
                                                            ifelse((substr(base_2$CAUSABAS,1,3) >= "K50") & (substr(base_2$CAUSABAS,1,3) <= "K52"),5,
                                                                   ifelse((substr(base_2$CAUSABAS,1,3) >= "K55") & (substr(base_2$CAUSABAS,1,3) <= "K63"),6,
                                                                          ifelse((substr(base_2$CAUSABAS,1,3) >= "K65") & (substr(base_2$CAUSABAS,1,3) <= "K67"),7,
                                                                                 ifelse((substr(base_2$CAUSABAS,1,3) >= "K70") & (substr(base_2$CAUSABAS,1,3) <= "K77"),8,
                                                                                        ifelse((substr(base_2$CAUSABAS,1,3) >= "K80") & (substr(base_2$CAUSABAS,1,3) <= "K87"),9,
                                                                                               ifelse((substr(base_2$CAUSABAS,1,3) >= "K90") & (substr(base_2$CAUSABAS,1,3) <= "K93"),10,9999))))))))))

base_2 %>% mutate_at(vars("CAUSABAS_DOEN_DIG"), ~replace_na(.,999))#tranformei os NA em 999
base_2 <- base_2 %>% mutate_at(vars("CAUSABAS_DOEN_DIG"), ~replace_na(.,999)) #criei um df
base_2 %>% colnames # verificando as variaveis
base_2$CAUSABAS_DOEN_DIG %>% table (useNA = "always") # verificando NA

# Criando uma nova coluna para o subgrupo k70 a k77 somente

base_2$DOEN_FIG <- ifelse(grepl("^K70", base_2$CAUSABAS), 1,
                          ifelse(grepl("^K71", base_2$CAUSABAS), 2,
                                 ifelse(grepl("^K72", base_2$CAUSABAS), 3,
                                        ifelse(grepl("^K73", base_2$CAUSABAS), 4,
                                               ifelse(grepl("^K74", base_2$CAUSABAS), 5,
                                                      ifelse(grepl("^K75", base_2$CAUSABAS), 6,
                                                             ifelse(grepl("^K76", base_2$CAUSABAS), 7,
                                                                    ifelse(grepl("^K77", base_2$CAUSABAS), 8, 9999)
                                                             )))))))


table(base_2$DOEN_FIG)
base_2 %>% mutate_at(vars("DOEN_FIG"), ~replace_na(.,999))#tranformei os NA em 999
base_2 <- base_2 %>% mutate_at(vars("DOEN_FIG"), ~replace_na(.,999)) #criei um df
base_2 %>% colnames # verificando as variaveis
base_2$DOEN_FIG %>% table (useNA = "always") # verificando NA


#salvar base fisica 
write.csv(base_2, file = "base_3_limpa_categor.csv")

#FILTTRANDO OS DADOS PARA CADA CATEGORIA (OBITOS GERAIS, TRABALHADORES GERAIS E TRABALHADORES AGRO)-----

# RECORTANDO BASE DE 18 A 69 ANOS -----

base_4_idade_18_69 <- base_3 %>%
  filter(IDADE_REAL >= 18 & IDADE_REAL <= 69 | IDADE_NOVO == 999) %>%
  select(SEXO_NOVO, IDADE, IDADE_NOVO,IDADE_REAL,IDADE_NOVO_NUM, RACACOR_NOVO, ESC_NOVO, ESTCIV_NOVO, EXAME_NOVO, ASSISTMED_NOVO, 
         CODMUNRES, MACRORREGIAO, TIPOLOGIA, OCUP_NOVO_CAT2D,CAUSABAS_BAS_CAP, CAUSABAS_DOEN_DIG, DOEN_FIG)
#CONSTRUINDO TABELA PARA DADOS GERAIS -----
## N absoluto e relativo para dados gerais-----
table (base_4_idade_18_69$SEXO_NOVO)
base_4_idade_18_69$SEXO_NOVO %>% sort %>% table (useNA = "always") %>% prop.table() %>% "*"(100)

table (base_4_idade_18_69$IDADE_NOVO)
base_4_idade_18_69$IDADE_NOVO %>% sort %>% table (useNA = "always") %>% prop.table() %>% "*"(100)

table (base_4_idade_18_69$RACACOR_NOVO)
base_4_idade_18_69$RACACOR_NOVO  %>% sort %>% table (useNA = "always") %>% prop.table() %>% "*"(100)

table (base_4_idade_18_69$ESC_NOVO)
base_4_idade_18_69$ESC_NOVO  %>% sort %>% table (useNA = "always") %>% prop.table() %>% "*"(100)

table (base_4_idade_18_69$ESTCIV_NOVO)
base_4_idade_18_69$ESTCIV_NOVO  %>% sort %>% table (useNA = "always") %>% prop.table() %>% "*"(100)

table (base_4_idade_18_69$ASSISTMED_NOVO)
base_4_idade_18_69$ASSISTMED_NOVO  %>% sort %>% table (useNA = "always") %>% prop.table() %>% "*"(100)

table (base_4_idade_18_69$EXAME_NOVO)
base_4_idade_18_69$EXAME_NOVO  %>% sort %>% table (useNA = "always") %>% prop.table() %>% "*"(100)

table (base_4_idade_18_69$MACRORREGIAO)
base_4_idade_18_69$MACRORREGIAO  %>% sort %>% table (useNA = "always") %>% prop.table() %>% "*"(100)

table (base_4_idade_18_69$DOEN_FIG)
base_4_idade_18_69$DOEN_FIG  %>% sort %>% table (useNA = "always") %>% prop.table() %>% "*"(100)

table (base_4_idade_18_69$TIPOLOGIA)
base_4_idade_18_69$TIPOLOGIA  %>% sort %>% table (useNA = "always") %>% prop.table() %>% "*"(100)

##Calculando a média e o desvio padrão da idade para os óbitos gerais-----

resumo_idade <- base_4_idade_18_69 %>%
  summarize(media_idade = mean(IDADE_REAL),
            desvio_padrao_idade = sd(IDADE_REAL))


##N absoluto e relativo para k70 a k77(doenças do figado) dados gerais------

count_sexo <- base_4_idade_18_69 %>%
  filter(CAUSABAS_DOEN_DIG == 8) %>%
  group_by(SEXO_NOVO) %>%
  summarize(count = n()) %>%
  ungroup()%>%
  mutate(prop = count / sum(count) * 100)

count_idade <- base_4_idade_18_69 %>%
  filter(CAUSABAS_DOEN_DIG == 8) %>%
  group_by(IDADE_NOVO) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_racacor <- base_4_idade_18_69 %>%
  filter(CAUSABAS_DOEN_DIG == 8) %>%
  group_by(RACACOR_NOVO) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_esc <- base_4_idade_18_69 %>%
  filter(CAUSABAS_DOEN_DIG == 8) %>%
  group_by(ESC_NOVO) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_estcivil <- base_4_idade_18_69 %>%
  filter(CAUSABAS_DOEN_DIG == 8) %>%
  group_by(ESTCIV_NOVO) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_assistmed <- base_4_idade_18_69 %>%
  filter(CAUSABAS_DOEN_DIG == 8) %>%
  group_by(ASSISTMED_NOVO) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_exame <- base_4_idade_18_69 %>%
  filter(CAUSABAS_DOEN_DIG == 8) %>%
  group_by(EXAME_NOVO) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_regiao <- base_4_idade_18_69 %>%
  filter(CAUSABAS_DOEN_DIG == 8) %>%
  group_by(MACRORREGIAO) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)


##Filtrando so a tipologia igbe e doenças do figado -----

count_k70 <- base_4_idade_18_69 %>%
  filter(DOEN_FIG == 1) %>%  # Assuming 1 represents the condition for filtering DOEN_FIG
  select(DOEN_FIG, TIPOLOGIA) %>%
  group_by(TIPOLOGIA) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_k71 <- base_4_idade_18_69 %>%
  filter(DOEN_FIG == 2) %>%  # Assuming 1 represents the condition for filtering DOEN_FIG
  select(DOEN_FIG, TIPOLOGIA) %>%
  group_by(TIPOLOGIA) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_k72 <- base_4_idade_18_69 %>%
  filter(DOEN_FIG == 3) %>%  # Assuming 1 represents the condition for filtering DOEN_FIG
  select(DOEN_FIG, TIPOLOGIA) %>%
  group_by(TIPOLOGIA) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_k73 <- base_4_idade_18_69 %>%
  filter(DOEN_FIG == 4) %>%  # Assuming 1 represents the condition for filtering DOEN_FIG
  select(DOEN_FIG, TIPOLOGIA) %>%
  group_by(TIPOLOGIA) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_k74 <- base_4_idade_18_69 %>%
  filter(DOEN_FIG == 5) %>%  # Assuming 1 represents the condition for filtering DOEN_FIG
  select(DOEN_FIG, TIPOLOGIA) %>%
  group_by(TIPOLOGIA) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_k75 <- base_4_idade_18_69 %>%
  filter(DOEN_FIG == 6) %>%  # Assuming 1 represents the condition for filtering DOEN_FIG
  select(DOEN_FIG, TIPOLOGIA) %>%
  group_by(TIPOLOGIA) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_k76 <- base_4_idade_18_69 %>%
  filter(DOEN_FIG == 7) %>%  # Assuming 1 represents the condition for filtering DOEN_FIG
  select(DOEN_FIG, TIPOLOGIA) %>%
  group_by(TIPOLOGIA) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

##Média e o desvio padrão da idade_real para os casos relacionados à variável DOEN_FIG-----

resumo_idade_doen_fig <- base_4_idade_18_69 %>%
  filter(!is.na(CAUSABAS_DOEN_DIG == 8)) %>%
  group_by(CAUSABAS_DOEN_DIG) %>%
  summarize(media_idade = mean(IDADE_REAL),
            desvio_padrao_idade = sd(IDADE_REAL))

# CONSTRUINDO TABELA PARA TRABALHADORES GERAIS, K70 A K77-----

base_nao_agro_18_69 <- base_3 %>%
  filter(OCUP_NOVO_CAT2D == "2" & IDADE_REAL >= 18 & IDADE_REAL <= 69 & CAUSABAS_DOEN_DIG == 8)

##Categorizando os codigos dos municipios em apenas dois digitos-----
base_nao_agro_18_69 <- base_nao_agro_18_69 %>% 
  mutate(CODIGO_RES = substr(CODMUNRES, 1, 2))
base_nao_agro_18_69 %>% relocate(CODIGO_RES, .after = "CODMUNRES") #realocando a nova variavel ao lado da antiga
base_nao_agro_18_69 <- base_nao_agro_18_69 %>% relocate(CODIGO_RES, .after = "CODMUNRES") #Atribui um objeto a mudan?a
base_nao_agro_18_69 %>% colnames
#Dando nome
base_nao_agro_18_69 <- base_nao_agro_18_69 %>% 
  mutate(ESTADO = case_when(
    substr(CODMUNRES, 1, 2) == "12" ~ "Acre",
    substr(CODMUNRES, 1, 2) == "27" ~ "Alagoas",
    substr(CODMUNRES, 1, 2) == "16" ~ "Amapá",
    substr(CODMUNRES, 1, 2) == "13" ~ "Amazonas",
    substr(CODMUNRES, 1, 2) == "29" ~ "Bahia",
    substr(CODMUNRES, 1, 2) == "23" ~ "Ceará",
    substr(CODMUNRES, 1, 2) == "53" ~ "Distrito Federal",
    substr(CODMUNRES, 1, 2) == "32" ~ "Espírito Santo",
    substr(CODMUNRES, 1, 2) == "52" ~ "Goiás",
    substr(CODMUNRES, 1, 2) == "21" ~ "Maranhão",
    substr(CODMUNRES, 1, 2) == "51" ~ "Mato Grosso",
    substr(CODMUNRES, 1, 2) == "50" ~ "Mato Grosso do Sul",
    substr(CODMUNRES, 1, 2) == "31" ~ "Minas Gerais",
    substr(CODMUNRES, 1, 2) == "15" ~ "Pará",
    substr(CODMUNRES, 1, 2) == "25" ~ "Paraíba",
    substr(CODMUNRES, 1, 2) == "41" ~ "Paraná",
    substr(CODMUNRES, 1, 2) == "26" ~ "Pernambuco",
    substr(CODMUNRES, 1, 2) == "22" ~ "Piauí",
    substr(CODMUNRES, 1, 2) == "24" ~ "Rio Grande do Norte",
    substr(CODMUNRES, 1, 2) == "43" ~ "Rio Grande do Sul",
    substr(CODMUNRES, 1, 2) == "33" ~ "Rio de Janeiro",
    substr(CODMUNRES, 1, 2) == "11" ~ "Rondônia",
    substr(CODMUNRES, 1, 2) == "14" ~ "Roraima",
    substr(CODMUNRES, 1, 2) == "42" ~ "Santa Catarina",
    substr(CODMUNRES, 1, 2) == "35" ~ "São Paulo",
    substr(CODMUNRES, 1, 2) == "28" ~ "Sergipe",
    substr(CODMUNRES, 1, 2) == "17" ~ "Tocantins"
  ))

base_nao_agro_18_69 %>% relocate(ESTADO, .after = "CODIGO_RES") #realocando a nova variavel ao lado da antiga
base_nao_agro_18_69 <- base_nao_agro_18_69 %>% relocate(ESTADO, .after = "CODIGO_RES") #Atribui um objeto a mudan?a
base_nao_agro_18_69 %>% colnames

table(base_nao_agro_18_69$ESTADO)

##N total e percentual dos determinantes-----
count_sexo_nao_agro <- base_nao_agro_18_69 %>%
  filter(CAUSABAS_DOEN_DIG == 8) %>%
  group_by(SEXO_NOVO) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_idade_nao_agro <- base_nao_agro_18_69 %>%
  filter(CAUSABAS_DOEN_DIG == 8) %>%
  group_by(IDADE_NOVO) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_racacor_nao_agro <- base_nao_agro_18_69 %>%
  filter(CAUSABAS_DOEN_DIG == 8) %>%
  group_by(RACACOR_NOVO) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_esc_nao_agro <- base_nao_agro_18_69 %>%
  filter(CAUSABAS_DOEN_DIG == 8) %>%
  group_by(ESC_NOVO) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_estciv_nao_agro <- base_nao_agro_18_69 %>%
  filter(CAUSABAS_DOEN_DIG == 8) %>%
  group_by(ESTCIV_NOVO) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_assistmed_nao_agro <- base_nao_agro_18_69 %>%
  filter(CAUSABAS_DOEN_DIG == 8) %>%
  group_by(ASSISTMED_NOVO) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_regiao_nao_agro <- base_nao_agro_18_69 %>%
  filter(CAUSABAS_DOEN_DIG == 8) %>%
  group_by(MACRORREGIAO) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

##Média e o desvio padrão -----

resumo_idade_doen_fig_nao_agro <- base_nao_agro_18_69 %>%
  filter(!is.na(CAUSABAS_DOEN_DIG == 8)) %>%
  group_by(CAUSABAS_DOEN_DIG) %>%
  summarize(media_idade = mean(IDADE_REAL),
            desvio_padrao_idade = sd(IDADE_REAL))

##Filtrando para cada subgrupo -----
table(base_nao_agro_18_69$DOEN_FIG)
count_doenfig_nao_agro <- base_nao_agro_18_69 %>%
  filter(DOEN_FIG %in% c(1,2,3,4,5,6,7)) %>%
  group_by(DOEN_FIG) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

##Calculando a média e o desvio padrão da idade_real para os casos relacionados à variável DOEN_FIG-----

resumo_idade_doen_fig_agro <- base_nao_agro_18_69 %>%
  filter(!is.na(CAUSABAS_DOEN_DIG == 8)) %>%
  group_by(CAUSABAS_DOEN_DIG) %>%
  summarize(media_idade = mean(IDADE_REAL),
            desvio_padrao_idade = sd(IDADE_REAL))

resumo_idade_subgrupos <- base_nao_agro_18_69 %>%
  filter(!is.na(CAUSABAS_DOEN_DIG == 8)) %>%
  group_by(DOEN_FIG) %>%
  summarize(media_idade = mean(IDADE_REAL),
            desvio_padrao_idade = sd(IDADE_REAL))

resumo_idade_sexo <- base_nao_agro_18_69 %>%
  filter(!is.na(CAUSABAS_DOEN_DIG == 8)) %>%
  group_by(SEXO_NOVO) %>%
  summarize(media_idade = mean(IDADE_REAL),
            desvio_padrao_idade = sd(IDADE_REAL))

resumo_idade_faixaetaria <- base_nao_agro_18_69 %>%
  filter(!is.na(CAUSABAS_DOEN_DIG == 8)) %>%
  group_by(IDADE_NOVO) %>%
  summarize(media_idade = mean(IDADE_REAL),
            desvio_padrao_idade = sd(IDADE_REAL))

resumo_idade_racacor <- base_nao_agro_18_69 %>%
  filter(!is.na(CAUSABAS_DOEN_DIG == 8)) %>%
  group_by(RACACOR_NOVO) %>%
  summarize(media_idade = mean(IDADE_REAL),
            desvio_padrao_idade = sd(IDADE_REAL))

resumo_idade_esc <- base_nao_agro_18_69 %>%
  filter(!is.na(CAUSABAS_DOEN_DIG == 8)) %>%
  group_by(ESC_NOVO) %>%
  summarize(media_idade = mean(IDADE_REAL),
            desvio_padrao_idade = sd(IDADE_REAL))

resumo_idade_estciv <- base_nao_agro_18_69 %>%
  filter(!is.na(CAUSABAS_DOEN_DIG == 8)) %>%
  group_by(ESTCIV_NOVO) %>%
  summarize(media_idade = mean(IDADE_REAL),
            desvio_padrao_idade = sd(IDADE_REAL))

resumo_idade_assistmed <- base_nao_agro_18_69 %>%
  filter(!is.na(CAUSABAS_DOEN_DIG == 8)) %>%
  group_by(ASSISTMED_NOVO) %>%
  summarize(media_idade = mean(IDADE_REAL),
            desvio_padrao_idade = sd(IDADE_REAL))

resumo_idade_macrorregiao <- base_nao_agro_18_69 %>%
  filter(!is.na(CAUSABAS_DOEN_DIG == 8)) %>%
  group_by(MACRORREGIAO) %>%
  summarize(media_idade = mean(IDADE_REAL),
            desvio_padrao_idade = sd(IDADE_REAL))

resumo_idade_tipologia <- base_nao_agro_18_69 %>%
  filter(!is.na(CAUSABAS_DOEN_DIG == 8)) %>%
  group_by(TIPOLOGIA) %>%
  summarize(media_idade = mean(IDADE_REAL),
            desvio_padrao_idade = sd(IDADE_REAL))

##Filtrando so a tipologia igbe e doenças do figado so pra trabalhadores não AGRO-----

count_k70 <- base_nao_agro_18_69 %>%
  filter(DOEN_FIG == 1) %>%  # Assuming 1 represents the condition for filtering DOEN_FIG
  select(DOEN_FIG, TIPOLOGIA) %>%
  group_by(TIPOLOGIA) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_k71 <- base_nao_agro_18_69 %>%
  filter(DOEN_FIG == 2) %>%  # Assuming 1 represents the condition for filtering DOEN_FIG
  select(DOEN_FIG, TIPOLOGIA) %>%
  group_by(TIPOLOGIA) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_k72 <- base_nao_agro_18_69 %>%
  filter(DOEN_FIG == 3) %>%  # Assuming 1 represents the condition for filtering DOEN_FIG
  select(DOEN_FIG, TIPOLOGIA) %>%
  group_by(TIPOLOGIA) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_k73 <- base_nao_agro_18_69 %>%
  filter(DOEN_FIG == 4) %>%  # Assuming 1 represents the condition for filtering DOEN_FIG
  select(DOEN_FIG, TIPOLOGIA) %>%
  group_by(TIPOLOGIA) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_k74 <- base_nao_agro_18_69 %>%
  filter(DOEN_FIG == 5) %>%  # Assuming 1 represents the condition for filtering DOEN_FIG
  select(DOEN_FIG, TIPOLOGIA) %>%
  group_by(TIPOLOGIA) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_k75 <- base_nao_agro_18_69 %>%
  filter(DOEN_FIG == 6) %>%  # Assuming 1 represents the condition for filtering DOEN_FIG
  select(DOEN_FIG, TIPOLOGIA) %>%
  group_by(TIPOLOGIA) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_k76 <- base_nao_agro_18_69 %>%
  filter(DOEN_FIG == 7) %>%  
  select(DOEN_FIG, TIPOLOGIA) %>%
  group_by(TIPOLOGIA) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)


#CONSTRUINDO TABELA TRABALHADORES AGRO, K70 A K77-----

base_agro_18_69 <- base_3 %>%
  filter(OCUP_NOVO_CAT2D == "1" & IDADE_REAL >= 18 & IDADE_REAL <= 69 & CAUSABAS_DOEN_DIG == 8)

##Categorizando os codigos dos municipios em apenas dois digitos-----
base_agro_18_69 <- base_agro_18_69 %>% 
  mutate(CODIGO_RES = substr(CODMUNRES, 1, 2))
base_agro_18_69 %>% relocate(CODIGO_RES, .after = "CODMUNRES") #realocando a nova variavel ao lado da antiga
base_agro_18_69 <- base_agro_18_69 %>% relocate(CODIGO_RES, .after = "CODMUNRES") #Atribui um objeto a mudan?a
base_agro_18_69 %>% colnames
#Dando nome
base_agro_18_69 <- base_agro_18_69 %>% 
  mutate(ESTADO = case_when(
    substr(CODMUNRES, 1, 2) == "12" ~ "Acre",
    substr(CODMUNRES, 1, 2) == "27" ~ "Alagoas",
    substr(CODMUNRES, 1, 2) == "16" ~ "Amapá",
    substr(CODMUNRES, 1, 2) == "13" ~ "Amazonas",
    substr(CODMUNRES, 1, 2) == "29" ~ "Bahia",
    substr(CODMUNRES, 1, 2) == "23" ~ "Ceará",
    substr(CODMUNRES, 1, 2) == "53" ~ "Distrito Federal",
    substr(CODMUNRES, 1, 2) == "32" ~ "Espírito Santo",
    substr(CODMUNRES, 1, 2) == "52" ~ "Goiás",
    substr(CODMUNRES, 1, 2) == "21" ~ "Maranhão",
    substr(CODMUNRES, 1, 2) == "51" ~ "Mato Grosso",
    substr(CODMUNRES, 1, 2) == "50" ~ "Mato Grosso do Sul",
    substr(CODMUNRES, 1, 2) == "31" ~ "Minas Gerais",
    substr(CODMUNRES, 1, 2) == "15" ~ "Pará",
    substr(CODMUNRES, 1, 2) == "25" ~ "Paraíba",
    substr(CODMUNRES, 1, 2) == "41" ~ "Paraná",
    substr(CODMUNRES, 1, 2) == "26" ~ "Pernambuco",
    substr(CODMUNRES, 1, 2) == "22" ~ "Piauí",
    substr(CODMUNRES, 1, 2) == "24" ~ "Rio Grande do Norte",
    substr(CODMUNRES, 1, 2) == "43" ~ "Rio Grande do Sul",
    substr(CODMUNRES, 1, 2) == "33" ~ "Rio de Janeiro",
    substr(CODMUNRES, 1, 2) == "11" ~ "Rondônia",
    substr(CODMUNRES, 1, 2) == "14" ~ "Roraima",
    substr(CODMUNRES, 1, 2) == "42" ~ "Santa Catarina",
    substr(CODMUNRES, 1, 2) == "35" ~ "São Paulo",
    substr(CODMUNRES, 1, 2) == "28" ~ "Sergipe",
    substr(CODMUNRES, 1, 2) == "17" ~ "Tocantins"
  ))

base_agro_18_69 %>% relocate(ESTADO, .after = "CODIGO_RES") #realocando a nova variavel ao lado da antiga
base_agro_18_69 <- base_agro_18_69 %>% relocate(ESTADO, .after = "CODIGO_RES") #Atribui um objeto a mudan?a
base_agro_18_69 %>% colnames

table(base_agro_18_69$ESTADO)

##N total e percentual para determinantes-----
count_sexo_agro <- base_agro_18_69 %>%
  filter(CAUSABAS_DOEN_DIG == 8) %>%
  group_by(SEXO_NOVO) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_idade_agro <- base_agro_18_69 %>%
  filter(CAUSABAS_DOEN_DIG == 8) %>%
  group_by(IDADE_NOVO) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_racacor_agro <- base_agro_18_69 %>%
  filter(CAUSABAS_DOEN_DIG == 8) %>%
  group_by(RACACOR_NOVO) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_esc_agro <- base_agro_18_69 %>%
  filter(CAUSABAS_DOEN_DIG == 8) %>%
  group_by(ESC_NOVO) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_estciv_agro <- base_agro_18_69 %>%
  filter(CAUSABAS_DOEN_DIG == 8) %>%
  group_by(ESTCIV_NOVO) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_assistmed_agro <- base_agro_18_69 %>%
  filter(CAUSABAS_DOEN_DIG == 8) %>%
  group_by(ASSISTMED_NOVO) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_exame_agro <- base_agro_18_69 %>%
  filter(CAUSABAS_DOEN_DIG == 8) %>%
  group_by(EXAME_NOVO) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_regiao_agro <- base_agro_18_69 %>%
  filter(CAUSABAS_DOEN_DIG == 8) %>%
  group_by(MACRORREGIAO) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

##Filtrando so a tipologia igbe e doenças do figado so pra AGRO-----

count_k70 <- base_agro_18_69 %>%
  filter(DOEN_FIG == 1) %>%  # Assuming 1 represents the condition for filtering DOEN_FIG
  select(DOEN_FIG, TIPOLOGIA) %>%
  group_by(TIPOLOGIA) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_k71 <- base_agro_18_69 %>%
  filter(DOEN_FIG == 2) %>%  # Assuming 1 represents the condition for filtering DOEN_FIG
  select(DOEN_FIG, TIPOLOGIA) %>%
  group_by(TIPOLOGIA) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_k72 <- base_agro_18_69 %>%
  filter(DOEN_FIG == 3) %>%  # Assuming 1 represents the condition for filtering DOEN_FIG
  select(DOEN_FIG, TIPOLOGIA) %>%
  group_by(TIPOLOGIA) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_k73 <- base_agro_18_69 %>%
  filter(DOEN_FIG == 4) %>%  # Assuming 1 represents the condition for filtering DOEN_FIG
  select(DOEN_FIG, TIPOLOGIA) %>%
  group_by(TIPOLOGIA) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_k74 <- base_agro_18_69 %>%
  filter(DOEN_FIG == 5) %>%  # Assuming 1 represents the condition for filtering DOEN_FIG
  select(DOEN_FIG, TIPOLOGIA) %>%
  group_by(TIPOLOGIA) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_k75 <- base_agro_18_69 %>%
  filter(DOEN_FIG == 6) %>%  # Assuming 1 represents the condition for filtering DOEN_FIG
  select(DOEN_FIG, TIPOLOGIA) %>%
  group_by(TIPOLOGIA) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

count_k76 <- base_agro_18_69 %>%
  filter(DOEN_FIG == 7) %>%  
  select(DOEN_FIG, TIPOLOGIA) %>%
  group_by(TIPOLOGIA) %>%
  summarize(count = n()) %>%
  ungroup() %>%
  mutate(prop = count / sum(count) * 100)

##Calculando a média e o desvio padrão da idade_real para os casos relacionados à variável DOEN_FIG-----

resumo_idade_doen_fig_agro <- base_agro_18_69 %>%
  filter(!is.na(CAUSABAS_DOEN_DIG == 8)) %>%
  group_by(CAUSABAS_DOEN_DIG) %>%
  summarize(media_idade = mean(IDADE_REAL),
            desvio_padrao_idade = sd(IDADE_REAL))

resumo_idade_subgrupos <- base_agro_18_69 %>%
  filter(!is.na(CAUSABAS_DOEN_DIG == 8)) %>%
  group_by(DOEN_FIG) %>%
  summarize(media_idade = mean(IDADE_REAL),
            desvio_padrao_idade = sd(IDADE_REAL))

resumo_idade_sexo <- base_agro_18_69 %>%
  filter(!is.na(CAUSABAS_DOEN_DIG == 8)) %>%
  group_by(SEXO_NOVO) %>%
  summarize(media_idade = mean(IDADE_REAL),
            desvio_padrao_idade = sd(IDADE_REAL))

resumo_idade_faixaetaria <- base_agro_18_69 %>%
  filter(!is.na(CAUSABAS_DOEN_DIG == 8)) %>%
  group_by(IDADE_NOVO) %>%
  summarize(media_idade = mean(IDADE_REAL),
            desvio_padrao_idade = sd(IDADE_REAL))

resumo_idade_racacor <- base_agro_18_69 %>%
  filter(!is.na(CAUSABAS_DOEN_DIG == 8)) %>%
  group_by(RACACOR_NOVO) %>%
  summarize(media_idade = mean(IDADE_REAL),
            desvio_padrao_idade = sd(IDADE_REAL))

resumo_idade_esc <- base_agro_18_69 %>%
  filter(!is.na(CAUSABAS_DOEN_DIG == 8)) %>%
  group_by(ESC_NOVO) %>%
  summarize(media_idade = mean(IDADE_REAL),
            desvio_padrao_idade = sd(IDADE_REAL))

resumo_idade_estciv <- base_agro_18_69 %>%
  filter(!is.na(CAUSABAS_DOEN_DIG == 8)) %>%
  group_by(ESTCIV_NOVO) %>%
  summarize(media_idade = mean(IDADE_REAL),
            desvio_padrao_idade = sd(IDADE_REAL))

resumo_idade_assistmed <- base_agro_18_69 %>%
  filter(!is.na(CAUSABAS_DOEN_DIG == 8)) %>%
  group_by(ASSISTMED_NOVO) %>%
  summarize(media_idade = mean(IDADE_REAL),
            desvio_padrao_idade = sd(IDADE_REAL))

resumo_idade_macrorregiao <- base_agro_18_69 %>%
  filter(!is.na(CAUSABAS_DOEN_DIG == 8)) %>%
  group_by(MACRORREGIAO) %>%
  summarize(media_idade = mean(IDADE_REAL),
            desvio_padrao_idade = sd(IDADE_REAL))

resumo_idade_tipologia <- base_agro_18_69 %>%
  filter(!is.na(CAUSABAS_DOEN_DIG == 8)) %>%
  group_by(TIPOLOGIA) %>%
  summarize(media_idade = mean(IDADE_REAL),
            desvio_padrao_idade = sd(IDADE_REAL))

#SALVANDO AS BASES FISICAS-----

#Base com filtro apenas de idade
write.csv(base_4_idade_18_69, file = "base_4_idade_18_69.csv")

#Base com filtro de idade (18 a 69 anos) e agricultores
write.csv(base_agro_18_69, file = "base_agro_18_69.csv")


